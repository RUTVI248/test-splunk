[
{
"action.email": "0",
"action.email.useNSSubject": "1",
"action.populate_lookup": "0",
"action.rss": "0",
"action.script": "0",
"action.summary_index": "0",
"action.summary_index.force_realtime_schedule": "0",
"alert.digest_mode": "1",
"alert.expires": "24h",
"alert.severity": "3",
"alert.track": "0",
"alert_type": "always",
"allow_skew": "0",
"auto_summarize": "0",
"auto_summarize.command": "| summarize override=partial timespan=$auto_summarize.timespan$ max_summary_size=$auto_summarize.max_summary_size$ max_summary_ratio=$auto_summarize.max_summary_ratio$ max_disabled_buckets=$auto_summarize.max_disabled_buckets$ max_time=$auto_summarize.max_time$ [ $search$ ]",
"auto_summarize.cron_schedule": "*/10 * * * *",
"auto_summarize.dispatch.time_format": "%FT%T.%Q%:z",
"auto_summarize.dispatch.ttl": "60",
"auto_summarize.max_concurrent": "1",
"auto_summarize.max_disabled_buckets": "2",
"auto_summarize.max_summary_ratio": "0.1",
"auto_summarize.max_summary_size": "52428800",
"auto_summarize.max_time": "3600",
"auto_summarize.suspend_period": "24h",
"defer_scheduled_searchable_idxc": "0",
"description": "Checks the audit logs to ensure that when a restore is requested, it was requested through the correct mechanism (via the command)",
"disabled": "0",
"dispatch.allow_partial_results": "1",
"dispatch.auto_cancel": "0",
"dispatch.auto_pause": "0",
"dispatch.buckets": "0",
"dispatch.earliest_time": "-60m@m",
"dispatch.latest_time": "now",
"dispatch.lookups": "1",
"dispatch.max_count": "500000",
"dispatch.max_time": "0",
"dispatch.rate_limit_retry": "0",
"dispatch.reduce_freq": "10",
"dispatch.rt_backfill": "0",
"dispatch.sample_ratio": "1",
"dispatch.spawn_process": "1",
"dispatch.time_format": "%FT%T.%Q%:z",
"dispatch.ttl": "2p",
"dispatchAs": "owner",
"display.events.fields": "[\"index\",\"sourcetype\",\"host\"]",
"display.events.list.drilldown": "none",
"display.events.list.wrap": "0",
"display.events.maxLines": "100",
"display.events.raw.drilldown": "none",
"display.events.rowNumbers": "1",
"display.events.table.drilldown": "0",
"display.events.table.wrap": "1",
"display.events.type": "list",
"display.general.enablePreview": "1",
"display.general.migratedFromViewState": "0",
"display.general.timeRangePicker.show": "1",
"display.general.type": "statistics",
"display.page.search.mode": "smart",
"display.page.search.patterns.sensitivity": "0.8",
"display.page.search.showFields": "1",
"display.page.search.tab": "statistics",
"display.page.search.timeline.format": "compact",
"display.page.search.timeline.scale": "linear",
"display.statistics.drilldown": "none",
"display.statistics.overlay": "none",
"display.statistics.percentagesRow": "0",
"display.statistics.rowNumbers": "0",
"display.statistics.show": "1",
"display.statistics.totalsRow": "0",
"display.statistics.wrap": "0",
"durable.backfill_type": "auto",
"durable.lag_time": "0",
"durable.max_backfill_intervals": "0",
"is_scheduled": "0",
"is_visible": "1",
"max_concurrent": "1",
"name": "Splunk Version Control Audit Query POST",
"owner": "nobody",
"precalculate_required_fields_for_alerts": "1",
"realtime_schedule": "1",
"request.ui_dispatch_app": "SplunkVersionControl",
"request.ui_dispatch_view": "search",
"restart_on_searchpeer_add": "1",
"run_n_times": "0",
"run_on_startup": "0",
"schedule_as": "auto",
"schedule_priority": "default",
"schedule_window": "0",
"search": "`comment(\"Query the audit logs to determine if the command | postversioncontrolrestore was used to send a request through. 2022-09-22 Splunk 9.0.1 appears to not log info=granted anymore, only completed\")` \nindex=_audit action=search info IN (granted, completed) `comment(\"For prod: savedsearch_name=\\\"search*\\\"\")` user=\"$username$\" `searchheadhosts`\n| rex \"(?s), search='(?P<search>.*)\\]$\" \n| rex \"(?s)^(?:[^'\\n]*'){4},\\s+\\w+='(?P<search>[\\s\\S]+)'\\]($|\\[[^\\]]+\\]$)\" \n| regex search=\"^\\| postversioncontrolrestore \"\n| eval time=strftime(_time,\"%s\")\n| table time, user",
"sharing": "app",
"skip_scheduled_realtime_idxc": "0"
},
{
"action.email": "0",
"action.populate_lookup": "0",
"action.rss": "0",
"action.script": "0",
"action.summary_index": "0",
"action.summary_index.force_realtime_schedule": "0",
"alert.digest_mode": "1",
"alert.expires": "24h",
"alert.severity": "3",
"alert.track": "0",
"alert_type": "always",
"allow_skew": "0",
"auto_summarize": "0",
"auto_summarize.command": "| summarize override=partial timespan=$auto_summarize.timespan$ max_summary_size=$auto_summarize.max_summary_size$ max_summary_ratio=$auto_summarize.max_summary_ratio$ max_disabled_buckets=$auto_summarize.max_disabled_buckets$ max_time=$auto_summarize.max_time$ [ $search$ ]",
"auto_summarize.cron_schedule": "*/10 * * * *",
"auto_summarize.dispatch.time_format": "%FT%T.%Q%:z",
"auto_summarize.dispatch.ttl": "60",
"auto_summarize.max_concurrent": "1",
"auto_summarize.max_disabled_buckets": "2",
"auto_summarize.max_summary_ratio": "0.1",
"auto_summarize.max_summary_size": "52428800",
"auto_summarize.max_time": "3600",
"auto_summarize.suspend_period": "24h",
"defer_scheduled_searchable_idxc": "0",
"disabled": "0",
"dispatch.allow_partial_results": "1",
"dispatch.auto_cancel": "0",
"dispatch.auto_pause": "0",
"dispatch.buckets": "0",
"dispatch.earliest_time": "-24h@h",
"dispatch.latest_time": "now",
"dispatch.lookups": "1",
"dispatch.max_count": "500000",
"dispatch.max_time": "0",
"dispatch.rate_limit_retry": "0",
"dispatch.reduce_freq": "10",
"dispatch.rt_backfill": "0",
"dispatch.sample_ratio": "1",
"dispatch.spawn_process": "1",
"dispatch.time_format": "%FT%T.%Q%:z",
"dispatch.ttl": "2p",
"dispatchAs": "owner",
"display.events.fields": "[\"index\",\"sourcetype\",\"host\"]",
"display.events.list.drilldown": "none",
"display.events.list.wrap": "0",
"display.events.maxLines": "100",
"display.events.raw.drilldown": "none",
"display.events.rowNumbers": "1",
"display.events.table.drilldown": "0",
"display.events.table.wrap": "1",
"display.events.type": "raw",
"display.general.enablePreview": "1",
"display.general.migratedFromViewState": "0",
"display.general.timeRangePicker.show": "1",
"display.general.type": "statistics",
"display.page.search.mode": "fast",
"display.page.search.patterns.sensitivity": "0.8",
"display.page.search.showFields": "1",
"display.page.search.tab": "statistics",
"display.page.search.timeline.format": "compact",
"display.page.search.timeline.scale": "linear",
"display.statistics.drilldown": "none",
"display.statistics.overlay": "none",
"display.statistics.percentagesRow": "0",
"display.statistics.rowNumbers": "0",
"display.statistics.show": "1",
"display.statistics.totalsRow": "0",
"display.statistics.wrap": "0",
"durable.backfill_type": "auto",
"durable.lag_time": "0",
"durable.max_backfill_intervals": "0",
"is_scheduled": "0",
"is_visible": "1",
"max_concurrent": "1",
"name": "splunk_vc_kom_audit_summary",
"owner": "nobody",
"precalculate_required_fields_for_alerts": "1",
"realtime_schedule": "1",
"request.ui_dispatch_app": "SplunkVersionControl",
"request.ui_dispatch_view": "search",
"restart_on_searchpeer_add": "1",
"run_n_times": "0",
"run_on_startup": "0",
"schedule_as": "auto",
"schedule_priority": "default",
"schedule_window": "0",
"search": "| savedsearch KOM_Change_Audit_Summary \n| regex uri_path!=\"/en-[^/]+/manager/\" \n| eval obj_times=strftime(strptime(time_stamp,\"%H:%M:%S %d-%b-%Y\"),\"%Y-%m-%dT%H:%M:%S%z\")\n| rex mode=sed field=uri_path \"s/^\\/en-[^\\/]+\\/splunkd\\/__raw//g\" \n| stats values(ko_label) AS ko_label, values(action) AS action, values(edit_type) AS edit_type, values(origin_splunk_server) AS server, values(app_label) AS app_label, values(obj_times) AS obj_times by ko_type, user, app_name, ko_name, uri_path \n| rex field=uri_path \"/servicesNS/(?P<user_in_url>[^/]+)\" \n| eval scope=if(user_in_url==\"nobody\",\"app,global\",\"user\") \n| eval ko_type=case(ko_type==\"report\",\"savedsearches\",ko_type==\"dashboard\",\"dashboards\",ko_type==\"data_model\",\"datamodels\",ko_type==\"eventtype\",\"eventtypes\",ko_type==\"macro\",\"macros\",ko_type==\"extractions\",\"fieldextractions\",ko_type==\"lookup-transforms\",\"lookup_definition\",ko_type==\"lookups\",\"automatic_lookups\",1=1,ko_type) \n| eval ko_name=if(ko_name=\"NULL\",null(),ko_name) \n| fillnull ko_type value=\"NULL\" \n| eval _time=now()\n| fields - user_in_url, uri_path",
"sharing": "app",
"skip_scheduled_realtime_idxc": "0"
},
{
"action.email": "0",
"action.email.useNSSubject": "1",
"action.populate_lookup": "0",
"action.rss": "0",
"action.script": "0",
"action.summary_index": "0",
"action.summary_index.force_realtime_schedule": "0",
"alert.digest_mode": "1",
"alert.expires": "24h",
"alert.severity": "3",
"alert.track": "0",
"alert_type": "always",
"allow_skew": "0",
"auto_summarize": "0",
"auto_summarize.command": "| summarize override=partial timespan=$auto_summarize.timespan$ max_summary_size=$auto_summarize.max_summary_size$ max_summary_ratio=$auto_summarize.max_summary_ratio$ max_disabled_buckets=$auto_summarize.max_disabled_buckets$ max_time=$auto_summarize.max_time$ [ $search$ ]",
"auto_summarize.cron_schedule": "*/10 * * * *",
"auto_summarize.dispatch.time_format": "%FT%T.%Q%:z",
"auto_summarize.dispatch.ttl": "60",
"auto_summarize.max_concurrent": "1",
"auto_summarize.max_disabled_buckets": "2",
"auto_summarize.max_summary_ratio": "0.1",
"auto_summarize.max_summary_size": "52428800",
"auto_summarize.max_time": "3600",
"auto_summarize.suspend_period": "24h",
"defer_scheduled_searchable_idxc": "0",
"disabled": "0",
"dispatch.allow_partial_results": "1",
"dispatch.auto_cancel": "0",
"dispatch.auto_pause": "0",
"dispatch.buckets": "0",
"dispatch.earliest_time": "-60m@m",
"dispatch.latest_time": "now",
"dispatch.lookups": "1",
"dispatch.max_count": "500000",
"dispatch.max_time": "0",
"dispatch.rate_limit_retry": "0",
"dispatch.reduce_freq": "10",
"dispatch.rt_backfill": "0",
"dispatch.sample_ratio": "1",
"dispatch.spawn_process": "1",
"dispatch.time_format": "%FT%T.%Q%:z",
"dispatch.ttl": "2p",
"dispatchAs": "owner",
"display.events.fields": "[\"index\",\"sourcetype\",\"host\",\"indextime\",\"count\",\"search_id\",\"component\",\"indexes\",\"source\"]",
"display.events.list.drilldown": "none",
"display.events.list.wrap": "0",
"display.events.maxLines": "100",
"display.events.raw.drilldown": "none",
"display.events.rowNumbers": "1",
"display.events.table.drilldown": "0",
"display.events.table.wrap": "1",
"display.events.type": "list",
"display.general.enablePreview": "1",
"display.general.migratedFromViewState": "0",
"display.general.timeRangePicker.show": "1",
"display.general.type": "statistics",
"display.page.search.mode": "smart",
"display.page.search.patterns.sensitivity": "0.8",
"display.page.search.showFields": "1",
"display.page.search.tab": "statistics",
"display.page.search.timeline.format": "compact",
"display.page.search.timeline.scale": "linear",
"display.statistics.drilldown": "none",
"display.statistics.overlay": "none",
"display.statistics.percentagesRow": "0",
"display.statistics.rowNumbers": "0",
"display.statistics.show": "1",
"display.statistics.totalsRow": "0",
"display.statistics.wrap": "0",
"durable.backfill_type": "auto",
"durable.lag_time": "0",
"durable.max_backfill_intervals": "0",
"is_scheduled": "0",
"is_visible": "1",
"max_concurrent": "1",
"name": "SplunkVersionControl AddToLookup",
"owner": "nobody",
"precalculate_required_fields_for_alerts": "1",
"realtime_schedule": "1",
"request.ui_dispatch_app": "monitoring",
"request.ui_dispatch_view": "search",
"restart_on_searchpeer_add": "1",
"run_n_times": "0",
"run_on_startup": "0",
"schedule_as": "auto",
"schedule_priority": "default",
"schedule_window": "0",
"search": "| makeresults \n| eval app=\"$app$\", type=\"$type$\", name=\"$name$\", tag=\"$tag$\", user=\"$user$\", restoreAsUser=\"$restoreAsUser$\", scope=\"$scope$\"\n| eval time=strftime(_time,\"%s\")\n| fields - _time\n| outputlookup append=true splunkversioncontrol_restorelist",
"sharing": "app",
"skip_scheduled_realtime_idxc": "0"
},
{
"action.email": "0",
"action.email.useNSSubject": "1",
"action.populate_lookup": "0",
"action.rss": "0",
"action.script": "0",
"action.summary_index": "0",
"action.summary_index.force_realtime_schedule": "0",
"alert.digest_mode": "1",
"alert.expires": "24h",
"alert.severity": "3",
"alert.track": "0",
"alert_type": "always",
"allow_skew": "0",
"auto_summarize": "0",
"auto_summarize.command": "| summarize override=partial timespan=$auto_summarize.timespan$ max_summary_size=$auto_summarize.max_summary_size$ max_summary_ratio=$auto_summarize.max_summary_ratio$ max_disabled_buckets=$auto_summarize.max_disabled_buckets$ max_time=$auto_summarize.max_time$ [ $search$ ]",
"auto_summarize.cron_schedule": "*/10 * * * *",
"auto_summarize.dispatch.time_format": "%FT%T.%Q%:z",
"auto_summarize.dispatch.ttl": "60",
"auto_summarize.max_concurrent": "1",
"auto_summarize.max_disabled_buckets": "2",
"auto_summarize.max_summary_ratio": "0.1",
"auto_summarize.max_summary_size": "52428800",
"auto_summarize.max_time": "3600",
"auto_summarize.suspend_period": "24h",
"defer_scheduled_searchable_idxc": "0",
"description": "Checks the audit logs to ensure that when a restore is requested, it was requested through the correct mechanism (via the report, not randomly added to the lookup file as that could have a different username in there)",
"disabled": "0",
"dispatch.allow_partial_results": "1",
"dispatch.auto_cancel": "0",
"dispatch.auto_pause": "0",
"dispatch.buckets": "0",
"dispatch.earliest_time": "-5m",
"dispatch.latest_time": "now",
"dispatch.lookups": "1",
"dispatch.max_count": "500000",
"dispatch.max_time": "0",
"dispatch.rate_limit_retry": "0",
"dispatch.reduce_freq": "10",
"dispatch.rt_backfill": "0",
"dispatch.sample_ratio": "1",
"dispatch.spawn_process": "1",
"dispatch.time_format": "%FT%T.%Q%:z",
"dispatch.ttl": "2p",
"dispatchAs": "owner",
"display.events.fields": "[\"index\",\"sourcetype\",\"host\"]",
"display.events.list.drilldown": "none",
"display.events.list.wrap": "0",
"display.events.maxLines": "100",
"display.events.raw.drilldown": "none",
"display.events.rowNumbers": "1",
"display.events.table.drilldown": "0",
"display.events.table.wrap": "1",
"display.events.type": "list",
"display.general.enablePreview": "1",
"display.general.migratedFromViewState": "0",
"display.general.timeRangePicker.show": "1",
"display.general.type": "statistics",
"display.page.search.mode": "smart",
"display.page.search.patterns.sensitivity": "0.8",
"display.page.search.showFields": "1",
"display.page.search.tab": "statistics",
"display.page.search.timeline.format": "compact",
"display.page.search.timeline.scale": "linear",
"display.statistics.drilldown": "none",
"display.statistics.overlay": "none",
"display.statistics.percentagesRow": "0",
"display.statistics.rowNumbers": "0",
"display.statistics.show": "1",
"display.statistics.totalsRow": "0",
"display.statistics.wrap": "0",
"durable.backfill_type": "auto",
"durable.lag_time": "0",
"durable.max_backfill_intervals": "0",
"is_scheduled": "0",
"is_visible": "1",
"max_concurrent": "1",
"name": "SplunkVersionControl Audit Query",
"owner": "nobody",
"precalculate_required_fields_for_alerts": "1",
"realtime_schedule": "1",
"request.ui_dispatch_app": "monitoring",
"request.ui_dispatch_view": "search",
"restart_on_searchpeer_add": "1",
"run_n_times": "0",
"run_on_startup": "0",
"schedule_as": "auto",
"schedule_priority": "default",
"schedule_window": "0",
"search": "`comment(\"Query the audit logs to determine when the savedsearch was run that will update the lookup file. This information is used to ensure the update times match the actual updates to the lookup file...we don't want to restore based on manual lookup file updates as the user could be set to anyone in that file if edited manually! 2022-09-22 Splunk 9.0.1 appears to not log info=granted anymore, only completed\")` \nindex=_audit \"search='| savedsearch \\\"SplunkVersionControl AddToLookup\\\" app=\" savedsearch_name=\"search*\" action=search info IN (granted, completed) `searchheadhosts`\n| eval time=strftime(_time,\"%s\")\n| table time, user",
"sharing": "app",
"skip_scheduled_realtime_idxc": "0"
},
{
"action.email": "0",
"action.email.useNSSubject": "1",
"action.populate_lookup": "0",
"action.rss": "0",
"action.script": "0",
"action.summary_index": "0",
"action.summary_index.force_realtime_schedule": "0",
"alert.digest_mode": "1",
"alert.expires": "24h",
"alert.severity": "3",
"alert.track": "0",
"alert_type": "always",
"allow_skew": "0",
"auto_summarize": "0",
"auto_summarize.command": "| summarize override=partial timespan=$auto_summarize.timespan$ max_summary_size=$auto_summarize.max_summary_size$ max_summary_ratio=$auto_summarize.max_summary_ratio$ max_disabled_buckets=$auto_summarize.max_disabled_buckets$ max_time=$auto_summarize.max_time$ [ $search$ ]",
"auto_summarize.cron_schedule": "*/10 * * * *",
"auto_summarize.dispatch.time_format": "%FT%T.%Q%:z",
"auto_summarize.dispatch.ttl": "60",
"auto_summarize.max_concurrent": "1",
"auto_summarize.max_disabled_buckets": "2",
"auto_summarize.max_summary_ratio": "0.1",
"auto_summarize.max_summary_size": "52428800",
"auto_summarize.max_time": "3600",
"auto_summarize.suspend_period": "24h",
"defer_scheduled_searchable_idxc": "0",
"description": "Detect changes to Splunk configuration based on a epoch via the /services/directory REST API, this covers the majority but not all knowledge objects in Splunk",
"disabled": "0",
"dispatch.allow_partial_results": "1",
"dispatch.auto_cancel": "0",
"dispatch.auto_pause": "0",
"dispatch.buckets": "0",
"dispatch.earliest_time": "-24h@h",
"dispatch.latest_time": "now",
"dispatch.lookups": "1",
"dispatch.max_count": "500000",
"dispatch.max_time": "0",
"dispatch.rate_limit_retry": "0",
"dispatch.reduce_freq": "10",
"dispatch.rt_backfill": "0",
"dispatch.sample_ratio": "1",
"dispatch.spawn_process": "1",
"dispatch.time_format": "%FT%T.%Q%:z",
"dispatch.ttl": "2p",
"dispatchAs": "owner",
"display.events.fields": "[\"host\",\"source\",\"sourcetype\"]",
"display.events.list.drilldown": "full",
"display.events.list.wrap": "1",
"display.events.maxLines": "5",
"display.events.raw.drilldown": "full",
"display.events.rowNumbers": "0",
"display.events.table.drilldown": "1",
"display.events.table.wrap": "1",
"display.events.type": "list",
"display.general.enablePreview": "1",
"display.general.migratedFromViewState": "0",
"display.general.timeRangePicker.show": "0",
"display.general.type": "statistics",
"display.page.search.mode": "smart",
"display.page.search.patterns.sensitivity": "0.8",
"display.page.search.showFields": "1",
"display.page.search.tab": "statistics",
"display.page.search.timeline.format": "compact",
"display.page.search.timeline.scale": "linear",
"display.statistics.drilldown": "cell",
"display.statistics.overlay": "none",
"display.statistics.percentagesRow": "0",
"display.statistics.rowNumbers": "0",
"display.statistics.show": "1",
"display.statistics.totalsRow": "0",
"display.statistics.wrap": "1",
"durable.backfill_type": "auto",
"durable.lag_time": "0",
"durable.max_backfill_intervals": "0",
"is_scheduled": "0",
"is_visible": "1",
"max_concurrent": "1",
"name": "SplunkVersionControl ChangeDetector Directory",
"owner": "nobody",
"precalculate_required_fields_for_alerts": "1",
"realtime_schedule": "1",
"request.ui_dispatch_app": "VersionControl",
"request.ui_dispatch_view": "search",
"restart_on_searchpeer_add": "1",
"run_n_times": "0",
"run_on_startup": "0",
"schedule_as": "auto",
"schedule_priority": "default",
"schedule_window": "0",
"search": "| rest \"/servicesNS/-/-/directory\" count=0 splunk_server=local timeout=0 \n| table updated, eai:type, eai:acl.app, eai:location\n| eval updatedEpoch=strptime(updated,\"%Y-%m-%dT%H:%M:%S%:z\")\n| where updatedEpoch > $updatedEpoch$\n| rename eai:type AS type, eai:acl.app AS app, eai:location AS location\n| stats count by type, app\n| fields - count",
"sharing": "app",
"skip_scheduled_realtime_idxc": "0"
},
{
"action.email": "0",
"action.email.useNSSubject": "1",
"action.populate_lookup": "0",
"action.rss": "0",
"action.script": "0",
"action.summary_index": "0",
"action.summary_index.force_realtime_schedule": "0",
"alert.digest_mode": "1",
"alert.expires": "24h",
"alert.severity": "3",
"alert.track": "0",
"alert_type": "always",
"allow_skew": "0",
"auto_summarize": "0",
"auto_summarize.command": "| summarize override=partial timespan=$auto_summarize.timespan$ max_summary_size=$auto_summarize.max_summary_size$ max_summary_ratio=$auto_summarize.max_summary_ratio$ max_disabled_buckets=$auto_summarize.max_disabled_buckets$ max_time=$auto_summarize.max_time$ [ $search$ ]",
"auto_summarize.cron_schedule": "*/10 * * * *",
"auto_summarize.dispatch.time_format": "%FT%T.%Q%:z",
"auto_summarize.dispatch.ttl": "60",
"auto_summarize.max_concurrent": "1",
"auto_summarize.max_disabled_buckets": "2",
"auto_summarize.max_summary_ratio": "0.1",
"auto_summarize.max_summary_size": "52428800",
"auto_summarize.max_time": "3600",
"auto_summarize.suspend_period": "24h",
"defer_scheduled_searchable_idxc": "0",
"description": "Detect changes to Splunk configuration based on a epoch, this covers the remainder of the knowledge objects not covered by SplunkVersionControl ChangeDetector Directory",
"disabled": "0",
"dispatch.allow_partial_results": "1",
"dispatch.auto_cancel": "0",
"dispatch.auto_pause": "0",
"dispatch.buckets": "0",
"dispatch.earliest_time": "-24h@h",
"dispatch.latest_time": "now",
"dispatch.lookups": "1",
"dispatch.max_count": "500000",
"dispatch.max_time": "0",
"dispatch.rate_limit_retry": "0",
"dispatch.reduce_freq": "10",
"dispatch.rt_backfill": "0",
"dispatch.sample_ratio": "1",
"dispatch.spawn_process": "1",
"dispatch.time_format": "%FT%T.%Q%:z",
"dispatch.ttl": "2p",
"dispatchAs": "owner",
"display.events.fields": "[\"host\",\"source\",\"sourcetype\"]",
"display.events.list.drilldown": "full",
"display.events.list.wrap": "1",
"display.events.maxLines": "5",
"display.events.raw.drilldown": "full",
"display.events.rowNumbers": "0",
"display.events.table.drilldown": "1",
"display.events.table.wrap": "1",
"display.events.type": "list",
"display.general.enablePreview": "1",
"display.general.migratedFromViewState": "0",
"display.general.timeRangePicker.show": "0",
"display.general.type": "statistics",
"display.page.search.mode": "smart",
"display.page.search.patterns.sensitivity": "0.8",
"display.page.search.showFields": "1",
"display.page.search.tab": "statistics",
"display.page.search.timeline.format": "compact",
"display.page.search.timeline.scale": "linear",
"display.statistics.drilldown": "cell",
"display.statistics.overlay": "none",
"display.statistics.percentagesRow": "0",
"display.statistics.rowNumbers": "0",
"display.statistics.show": "1",
"display.statistics.totalsRow": "0",
"display.statistics.wrap": "1",
"durable.backfill_type": "auto",
"durable.lag_time": "0",
"durable.max_backfill_intervals": "0",
"is_scheduled": "0",
"is_visible": "1",
"max_concurrent": "1",
"name": "SplunkVersionControl ChangeDetector Non-Directory",
"owner": "nobody",
"precalculate_required_fields_for_alerts": "1",
"realtime_schedule": "1",
"request.ui_dispatch_app": "VersionControl",
"request.ui_dispatch_view": "search",
"restart_on_searchpeer_add": "1",
"run_n_times": "0",
"run_on_startup": "0",
"schedule_as": "auto",
"schedule_priority": "default",
"schedule_window": "0",
"search": "| rest splunk_server=local /servicesNS/-/-/storage/collections/config count=0 f=updated f=eai:appName | eval type=\"kvstore\"\n| append [ | rest splunk_server=local /servicesNS/-/-/datamodel/model count=0 f=updated f=eai:appName | eval type=\"datamodel\" | search `comment(\"These two datamodels are updating every hour but I cannot determine why, only calculationId changes so no requirement to back it up...\")` NOT id=\"https://127.0.0.1:8089/servicesNS/nobody/SA-ThreatIntelligence/datamodel/model/Incident_Management\" NOT id=\"https://127.0.0.1:8089/servicesNS/nobody/SA-ThreatIntelligence/datamodel/model/Risk\" ]\n| append [ | rest splunk_server=local /servicesNS/-/-/data/ui/panels count=0 f=updated f=eai:appName | eval type=\"panels\" ]\n| append [ | rest splunk_server=local /servicesNS/-/-/data/props/calcfields count=0 | table updated, eai:acl.app | rename eai:acl.app AS eai:appName | eval type=\"calcfields\" ]\n| append [ | rest splunk_server=local /servicesNS/-/-/configs/conf-macros count=0 | table updated, eai:acl.app | rename eai:acl.app AS eai:appName | eval type=\"macros\" ]\n| eval updatedEpoch=strptime(updated,\"%Y-%m-%dT%H:%M:%S%:z\")\n| where updatedEpoch > $updatedEpoch$\n| rename eai:appName AS app\n| stats count by type, app",
"sharing": "app",
"skip_scheduled_realtime_idxc": "0"
},
{
"action.email": "0",
"action.email.useNSSubject": "1",
"action.populate_lookup": "0",
"action.rss": "0",
"action.script": "0",
"action.summary_index": "0",
"action.summary_index.force_realtime_schedule": "0",
"alert.digest_mode": "1",
"alert.expires": "24h",
"alert.severity": "3",
"alert.track": "0",
"alert_type": "always",
"allow_skew": "0",
"auto_summarize": "0",
"auto_summarize.command": "| summarize override=partial timespan=$auto_summarize.timespan$ max_summary_size=$auto_summarize.max_summary_size$ max_summary_ratio=$auto_summarize.max_summary_ratio$ max_disabled_buckets=$auto_summarize.max_disabled_buckets$ max_time=$auto_summarize.max_time$ [ $search$ ]",
"auto_summarize.cron_schedule": "*/10 * * * *",
"auto_summarize.dispatch.time_format": "%FT%T.%Q%:z",
"auto_summarize.dispatch.ttl": "60",
"auto_summarize.max_concurrent": "1",
"auto_summarize.max_disabled_buckets": "2",
"auto_summarize.max_summary_ratio": "0.1",
"auto_summarize.max_summary_size": "52428800",
"auto_summarize.max_time": "3600",
"auto_summarize.suspend_period": "24h",
"defer_scheduled_searchable_idxc": "0",
"description": "Check if the user in question has admin level access or not",
"disabled": "0",
"dispatch.allow_partial_results": "1",
"dispatch.auto_cancel": "0",
"dispatch.auto_pause": "0",
"dispatch.buckets": "0",
"dispatch.earliest_time": "-5m",
"dispatch.latest_time": "now",
"dispatch.lookups": "1",
"dispatch.max_count": "500000",
"dispatch.max_time": "0",
"dispatch.rate_limit_retry": "0",
"dispatch.reduce_freq": "10",
"dispatch.rt_backfill": "0",
"dispatch.sample_ratio": "1",
"dispatch.spawn_process": "1",
"dispatch.time_format": "%FT%T.%Q%:z",
"dispatch.ttl": "2p",
"dispatchAs": "owner",
"display.events.fields": "[\"index\",\"sourcetype\",\"host\",\"indextime\",\"count\",\"search_id\",\"component\",\"indexes\",\"source\"]",
"display.events.list.drilldown": "none",
"display.events.list.wrap": "0",
"display.events.maxLines": "100",
"display.events.raw.drilldown": "none",
"display.events.rowNumbers": "1",
"display.events.table.drilldown": "0",
"display.events.table.wrap": "1",
"display.events.type": "list",
"display.general.enablePreview": "1",
"display.general.migratedFromViewState": "0",
"display.general.timeRangePicker.show": "1",
"display.general.type": "statistics",
"display.page.search.mode": "smart",
"display.page.search.patterns.sensitivity": "0.8",
"display.page.search.showFields": "1",
"display.page.search.tab": "statistics",
"display.page.search.timeline.format": "compact",
"display.page.search.timeline.scale": "linear",
"display.statistics.drilldown": "none",
"display.statistics.overlay": "none",
"display.statistics.percentagesRow": "0",
"display.statistics.rowNumbers": "0",
"display.statistics.show": "1",
"display.statistics.totalsRow": "0",
"display.statistics.wrap": "0",
"durable.backfill_type": "auto",
"durable.lag_time": "0",
"durable.max_backfill_intervals": "0",
"is_scheduled": "0",
"is_visible": "1",
"max_concurrent": "1",
"name": "SplunkVersionControl CheckAdmin",
"owner": "nobody",
"precalculate_required_fields_for_alerts": "1",
"realtime_schedule": "1",
"request.ui_dispatch_app": "monitoring",
"request.ui_dispatch_view": "search",
"restart_on_searchpeer_add": "1",
"run_n_times": "0",
"run_on_startup": "0",
"schedule_as": "auto",
"schedule_priority": "default",
"schedule_window": "0",
"search": "| rest /services/authentication/users splunk_server=local \n| table title, roles  \n| rename title AS username  \n| mvexpand roles \n| search roles=admin \n| search username IN ($usernameFilter$)\n| table username",
"sharing": "app",
"skip_scheduled_realtime_idxc": "0"
}
]
