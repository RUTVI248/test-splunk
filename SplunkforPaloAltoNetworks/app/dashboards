[
{
"eai:data": "<form version=\"1.1\">\n  <label>Cortex XDR Incidents</label>\n  <search id=\"basesearch\">\n    <query>sourcetype=\"pan:xdr_incident\" $incident_id$ $severity$ $status$ | eventstats latest(incident_id) by _time | fields _time starred incident_id severity score description hosts{} status assigned_user_pretty_name incident_sources{} xdr_url</query>\n    <earliest>$time.earliest$</earliest>\n    <latest>$time.latest$</latest>\n  </search>\n  <fieldset autoRun=\"true\" submitButton=\"true\">\n    <input type=\"time\" searchWhenChanged=\"true\" token=\"time\">\n      <label></label>\n      <default>\n        <earliest>-24h@h</earliest>\n        <latest>now</latest>\n      </default>\n    </input>\n    <input type=\"text\" token=\"incident_id\">\n      <label>Incident ID</label>\n      <default></default>\n      <prefix>incident_id=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"dropdown\" token=\"severity\" searchWhenChanged=\"false\">\n      <label>Severity</label>\n      <choice value=\"*\">All</choice>\n      <choice value=\"high\">High</choice>\n      <choice value=\"medium\">Medium</choice>\n      <choice value=\"low\">Low</choice>\n      <prefix>severity=\"</prefix>\n      <suffix>\"</suffix>\n      <default>*</default>\n    </input>\n    <input type=\"dropdown\" token=\"status\">\n      <label>Status</label>\n      <prefix>status=\"</prefix>\n      <default>*</default>\n      <suffix>\"</suffix>\n      <fieldForLabel>status</fieldForLabel>\n      <fieldForValue>status</fieldForValue>\n      <search base=\"basesearch\">\n        <query>| dedup status | table status | sort +\"status\"</query>\n      </search>\n      <choice value=\"*\">All</choice>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      <single>\n        <search base=\"basesearch\">\n          <query>| stats dc(incident_id)</query>\n        </search>\n        <option name=\"colorBy\">trend</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"numberPrecision\">0</option>\n        <option name=\"rangeColors\">[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]</option>\n        <option name=\"rangeValues\">[0,30,70,100]</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"showSparkline\">1</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <option name=\"trendColorInterpretation\">inverse</option>\n        <option name=\"trendInterval\">-1h</option>\n        <option name=\"underLabel\">Unique Incidents</option>\n        <option name=\"unitPosition\">after</option>\n        <option name=\"useColors\">0</option>\n        <option name=\"useThousandSeparators\">1</option>\n      </single>\n      <single>\n        <search base=\"basesearch\">\n          <query>| search status=new | stats dc(incident_id)</query>\n        </search>\n        <option name=\"colorBy\">value</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"numberPrecision\">0</option>\n        <option name=\"rangeColors\">[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]</option>\n        <option name=\"rangeValues\">[0,30,70,100]</option>\n        <option name=\"showSparkline\">1</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <option name=\"trendColorInterpretation\">standard</option>\n        <option name=\"trendDisplayMode\">absolute</option>\n        <option name=\"underLabel\">New Incidents</option>\n        <option name=\"unitPosition\">after</option>\n        <option name=\"useColors\">0</option>\n        <option name=\"useThousandSeparators\">1</option>\n      </single>\n      <single>\n        <search base=\"basesearch\">\n          <query>| search starred=true | stats dc(incident_id)</query>\n        </search>\n        <option name=\"colorBy\">value</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"numberPrecision\">0</option>\n        <option name=\"rangeColors\">[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]</option>\n        <option name=\"rangeValues\">[0,30,70,100]</option>\n        <option name=\"showSparkline\">1</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <option name=\"trendColorInterpretation\">standard</option>\n        <option name=\"trendDisplayMode\">absolute</option>\n        <option name=\"underLabel\">Starred Incidents</option>\n        <option name=\"unitPosition\">after</option>\n        <option name=\"useColors\">0</option>\n        <option name=\"useThousandSeparators\">1</option>\n      </single>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Incident Severity Over Time</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| search severity!=NULL | timechart dc(incident_id) by severity</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.abbreviation\">none</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.abbreviation\">none</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.abbreviation\">none</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">column</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.mode\">standard</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <option name=\"charting.lineWidth\">2</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Incidents by Status</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| stats dc(incident_id) as count by status</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.abbreviation\">none</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.abbreviation\">none</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.abbreviation\">none</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.mode\">standard</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <option name=\"charting.lineWidth\">2</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n      </chart>\n    </panel>\n    <panel>\n      <title>Incidents by Assignee</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| stats dc(incident_id) as count by assigned_user_pretty_name</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.abbreviation\">none</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.abbreviation\">none</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.abbreviation\">none</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.mode\">standard</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <option name=\"charting.lineWidth\">2</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Starred Incident Feed</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| search starred=true | eval \"Last Updated\" = strftime(_time, \"%Y-%m-%d %H:%M:%S\") | eval \"XDR Link\"=\"Open in XDR\" | rename incident_id AS \"Incident ID\", description AS \"Incident Description\", severity AS Severity, score AS Score, status AS Status, hosts{} AS Hosts, assigned_user_pretty_name AS \"Assigned To\", incident_sources{} AS \"Incident Sources\" | table \"Last Updated\" \"Incident ID\" Severity Score \"Incident Description\"  Hosts Status \"Assigned To\" \"Incident Sources\" xdr_url \"XDR Link\"  | sort -\"Last Udpated\"</query>\n        </search>\n        <option name=\"count\">15</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">cell</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n        <format type=\"color\" field=\"Severity\">\n          <colorPalette type=\"map\">{\"high\":#D93F3C,\"medium\":#F7BC38,\"low\":#65A637}</colorPalette>\n        </format>\n        <format type=\"color\" field=\"Score\">\n          <colorPalette type=\"minMidMax\" maxColor=\"#DC4E41\" minColor=\"#FFFFFF\"></colorPalette>\n          <scale type=\"minMidMax\" minValue=\"0\"></scale>\n        </format>\n        <format type=\"color\" field=\"Status\">\n          <colorPalette type=\"sharedList\"></colorPalette>\n          <scale type=\"sharedCategory\"></scale>\n        </format>\n        <fields>[\"Last Updated\",\"Incident ID\",\"Severity\",\"Score\",\"Incident Description\",\"Hosts\",\"Status\",\"Assigned To\",\"Incident Sources\",\"XDR Link\"]</fields>\n        <drilldown>\n          <condition field=\"XDR Link\">\n            <set token=\"inc-xdr_url\">$row.xdr_url$</set>\n            <link target=\"_blank\">\n              <![CDATA[$row.xdr_url|n$]]>\n            </link>\n          </condition>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Incident Feed</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| eval \"Last Updated\" = strftime(_time, \"%Y-%d-%m %H:%M:%S\") | eval \"XDR Link\"=\"Open in XDR\" | rename incident_id AS \"Incident ID\", description AS \"Incident Description\", severity AS Severity, score AS Score, status AS Status, hosts{} AS Hosts, assigned_user_pretty_name AS \"Assigned To\", incident_sources{} AS \"Incident Sources\" | table \"Last Updated\" \"Incident ID\" Severity Score \"Incident Description\"  Hosts Status \"Assigned To\" \"Incident Sources\" xdr_url \"XDR Link\"  | sort -\"Last Udpated\"</query>\n        </search>\n        <option name=\"count\">15</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">cell</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n        <format type=\"color\" field=\"Severity\">\n          <colorPalette type=\"map\">{\"high\":#D93F3C,\"medium\":#F7BC38,\"low\":#65A637}</colorPalette>\n        </format>\n        <format type=\"color\" field=\"Score\">\n          <colorPalette type=\"minMidMax\" maxColor=\"#DC4E41\" minColor=\"#FFFFFF\"></colorPalette>\n          <scale type=\"minMidMax\" minValue=\"0\"></scale>\n        </format>\n        <format type=\"color\" field=\"Status\">\n          <colorPalette type=\"sharedList\"></colorPalette>\n          <scale type=\"sharedCategory\"></scale>\n        </format>\n        <fields>[\"Last Updated\",\"Incident ID\",\"Severity\",\"Score\",\"Incident Description\",\"Hosts\",\"Status\",\"Assigned To\",\"Incident Sources\",\"XDR Link\"]</fields>\n        <drilldown>\n          <condition field=\"XDR Link\">\n            <set token=\"inc-xdr_url\">$row.xdr_url$</set>\n            <link target=\"_blank\">\n              <![CDATA[$row.xdr_url|n$]]>\n            </link>\n          </condition>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n</form>",
"eai:type": "views",
"name": "cortex_xdr_incidents",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<dashboard version=\"1.1\">\n  <label>Data Model Audit</label>\n  <row>\n    <panel>\n      <title>Next-generation Firewalls</title>\n      <single>\n        <search>\n          <query>| `pan_tstats` dc(log.serial_number) AS count FROM `fw_node(log)` GROUPBY _time | appendpipe [stats count | where count==0]</query>\n          <earliest>-24h@h</earliest>\n          <latest>now</latest>\n        </search>\n        <option name=\"colorBy\">trend</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"rangeColors\">[\"0xd93f3c\",\"0x000000\"]</option>\n        <option name=\"rangeValues\">[0]</option>\n        <option name=\"showSparkline\">0</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.size\">large</option>\n        <option name=\"trendDisplayMode\">absolute</option>\n        <option name=\"underLabel\">Reporting In Last 24 Hours</option>\n        <option name=\"useColors\">1</option>\n      </single>\n    </panel>\n    <panel>\n      <title>Logs Indexed - 24 Hours</title>\n      <single>\n        <search>\n          <query>`pan_logs` \n| stats count</query>\n          <earliest>-24h@h</earliest>\n          <latest>now</latest>\n        </search>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"rangeColors\">[\"0xd93f3c\",\"0x000000\"]</option>\n        <option name=\"rangeValues\">[0]</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.size\">large</option>\n        <option name=\"underLabel\">Next-generation Firewall Logs</option>\n        <option name=\"useColors\">1</option>\n      </single>\n      <single>\n        <search>\n          <query>`pan_aperture`\n| stats count</query>\n          <earliest>-24h@h</earliest>\n          <latest>now</latest>\n        </search>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"rangeColors\">[\"0xd93f3c\",\"0x000000\"]</option>\n        <option name=\"rangeValues\">[0]</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.size\">large</option>\n        <option name=\"underLabel\">Aperture Logs</option>\n        <option name=\"useColors\">1</option>\n      </single>\n    </panel>\n  </row>\n  <row>\n      </row>\n  <row>\n    <panel>\n      <title>Datamodel Acceleration Status</title>\n      <table>\n        <search>\n          <query>| stats count\n| eval datamodel=mvappend(\"pan_aperture\", \"pan_firewall\")\n| mvexpand datamodel \n| fields datamodel\n| join type=left datamodel \n    [| rest /servicesNS/nobody/SplunkforPaloAltoNetworks/admin/summarization by_tstats=t splunk_server=local count=0 \n    | search eai:acl.app=SplunkforPaloAltoNetworks \n    | eval datamodel=replace('summary.id',\"DM_\".'eai:acl.app'.\"_\",\"\")]\n| table datamodel summary.is_inprogress summary.size summary.latest_time summary.complete summary.last_error summary.time_range summary.earliest_time \n| rename summary.is_inprogress AS build_inprogress, summary.earliest_time AS earliest, summary.latest_time AS latest\n| rename summary.* AS *\n| sort datamodel \n| eval \"size(MB)\"=round(size/1048576,1), \"retention\"=if(time_range==0,\"unlimited\",round(time_range/86400,1)), \"build_complete(%)\"=round(complete*100,1) \n| eval acceleration=if(build_inprogress&gt;-1,\"enabled\",\"disabled\")\n| fieldformat earliest=strftime(earliest, \"%m/%d/%Y %H:%M:%S\") \n| fieldformat latest=strftime(latest, \"%m/%d/%Y %H:%M:%S\")\n| fields datamodel,acceleration,retention,earliest,latest,build_inprogress,build_complete(%),size(MB),last_error</query>\n          <earliest>-24h@h</earliest>\n          <latest>now</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">20</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n        <format type=\"color\" field=\"acceleration\">\n          <colorPalette type=\"map\">{\"disabled\":#D93F3C,\"enabled\":#A2CC3E}</colorPalette>\n        </format>\n        <format type=\"number\" field=\"retention(days)\">\n          <option name=\"precision\">0</option>\n          <option name=\"unit\">days</option>\n        </format>\n        <format type=\"number\" field=\"retention\">\n          <option name=\"precision\">0</option>\n          <option name=\"unit\">days</option>\n        </format>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Next-generation Firewall Accelerated Logs by Device - 24 hours</title>\n      <table>\n        <search>\n          <query>| `pan_tstats` count FROM `node(log)` `groupby(log.serial_number log.log_subtype)`\n| xyseries serial_number log_subtype count</query>\n          <earliest>-24h@h</earliest>\n          <latest>now</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">20</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n        <format type=\"color\" field=\"general\">\n          <colorPalette type=\"minMidMax\" maxColor=\"#31A35F\" minColor=\"#FFFFFF\"></colorPalette>\n          <scale type=\"minMidMax\"></scale>\n        </format>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Advanced Endpoint Protection Accelerated Logs by ESM - 24 hours</title>\n      <table>\n        <search>\n          <query>| `pan_tstats` count FROM `ep_node(log)` `groupby(log.src log.type)`\n| rename src AS ESM\n| xyseries ESM type count</query>\n          <earliest>-24h@h</earliest>\n          <latest>now</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">20</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n</dashboard>",
"eai:type": "views",
"name": "data_model_audit",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<form version=\"1.1\">\n  <label>Email Security</label>\n  <search id=\"basesearch\">\n    <query>| tstats summariesonly=t values(sourcetype) AS sourcetype, values(log.log_subtype) AS log.log_subtype,\n    values(log.threat_name) AS log.threat_name, values(log.severity) AS log.severity, values(log.app) AS log.app, values(log.bytes_in) AS log.bytes_in, values(log.bytes_out) AS log.bytes_out, values(log.sender) AS log.sender, values(log.user) AS log.user count FROM datamodel=\"pan_firewall\" WHERE (nodename=\"log.traffic.end\" OR nodename=\"log.threat\") (log.app:subcategory=\"email\" OR log.sender=\u201c*\u201d)      $serial$ $vsys$ $client_ip$ $server_ip$ \"$user|s$\" $app$ GROUPBY _time `session` | rename log.* AS *</query>\n    <earliest>$time.earliest$</earliest>\n    <latest>$time.latest$</latest>\n  </search>\n  <fieldset autoRun=\"true\" submitButton=\"true\">\n    <input type=\"time\" searchWhenChanged=\"true\" token=\"time\">\n      <label></label>\n      <default>\n        <earliest>-60m</earliest>\n        <latest>now</latest>\n      </default>\n    </input>\n    <input type=\"text\" token=\"serial\">\n      <label>Serial Number</label>\n      <default></default>\n      <prefix>log.serial_number=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"vsys\">\n      <label>Virtual System</label>\n      <default></default>\n      <prefix>log.vsys=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"client_ip\">\n      <label>Client IP</label>\n      <default></default>\n      <prefix>log.client_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"server_ip\">\n      <label>Destination IP</label>\n      <default></default>\n      <prefix>log.server_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"user\">\n      <label>Source User</label>\n      <default></default>\n      <prefix>log.user=</prefix>\n    </input>\n    <input type=\"text\" token=\"app\">\n      <label>Application</label>\n      <default></default>\n      <prefix>log.app=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      <single>\n        <search base=\"basesearch\">\n          <query>| search app=smtp AND bytes_in &gt; 0 | bucket _time span=1m | stats count by _time</query>\n        </search>\n        <option name=\"colorBy\">value</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"numberPrecision\">0</option>\n        <option name=\"rangeColors\">[\"0x65a637\",\"0x6db7c6\",\"0xf7bc38\",\"0xf58f39\",\"0xd93f3c\"]</option>\n        <option name=\"rangeValues\">[0,30,70,100]</option>\n        <option name=\"showSparkline\">1</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <option name=\"trendColorInterpretation\">standard</option>\n        <option name=\"trendDisplayMode\">absolute</option>\n        <option name=\"trendInterval\">-1m</option>\n        <option name=\"underLabel\">Inbound SMTP Emails per Minute</option>\n        <option name=\"unitPosition\">after</option>\n        <option name=\"useColors\">0</option>\n        <option name=\"useThousandSeparators\">1</option>\n      </single>\n    </panel>\n    <panel>\n      <single>\n        <search base=\"basesearch\">\n          <query>| search sourcetype=\"pan:threat\" | bucket _time span=1m | stats count by _time</query>\n        </search>\n        <option name=\"colorBy\">trend</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"numberPrecision\">0</option>\n        <option name=\"rangeColors\">[\"0x65a637\",\"0x6db7c6\",\"0xf7bc38\",\"0xf58f39\",\"0xd93f3c\"]</option>\n        <option name=\"rangeValues\">[0,30,70,100]</option>\n        <option name=\"showSparkline\">1</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <option name=\"trendColorInterpretation\">inverse</option>\n        <option name=\"trendDisplayMode\">absolute</option>\n        <option name=\"underLabel\">Email Threats Per Minute</option>\n        <option name=\"unitPosition\">after</option>\n        <option name=\"useColors\">1</option>\n        <option name=\"useThousandSeparators\">1</option>\n      </single>\n    </panel>\n    <panel>\n      <single>\n        <search base=\"basesearch\">\n          <query>| search app=smtp AND bytes_out &gt; 0 | bucket _time span=1m | stats count by _time</query>\n        </search>\n        <option name=\"colorBy\">value</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"numberPrecision\">0</option>\n        <option name=\"rangeColors\">[\"0x65a637\",\"0x6db7c6\",\"0xf7bc38\",\"0xf58f39\",\"0xd93f3c\"]</option>\n        <option name=\"rangeValues\">[0,30,70,100]</option>\n        <option name=\"showSparkline\">1</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <option name=\"trendColorInterpretation\">standard</option>\n        <option name=\"trendDisplayMode\">absolute</option>\n        <option name=\"trendInterval\">-1m</option>\n        <option name=\"underLabel\">Outbound SMTP Emails per Minute</option>\n        <option name=\"unitPosition\">after</option>\n        <option name=\"useColors\">0</option>\n        <option name=\"useThousandSeparators\">1</option>\n      </single>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Top Email Threats Source</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| stats count by client_ip user sender threat_name app | sort -count</query>\n        </search>\n        <option name=\"count\">15</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">row</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n        <drilldown>\n          <link target=\"_self\">search?q=eventtype=\"pan:emails\" OR eventtype=\"pan_email\" src_ip=$row.src_ip|s$ threat_name=$row.threat_name|s$ app=$row.app|s$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n    <panel>\n      <title>Large Email Senders</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| search bytes_out &gt; 0 | table client_ip sender user bytes_out count | sort -count</query>\n        </search>\n        <option name=\"count\">15</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">row</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n        <drilldown>\n          <link target=\"_self\">search?q=eventtype=\"pan:emails\" OR eventtype=\"pan_email\" src_ip=$row.src_ip|s$ sender=$row.sender|s$ bytes_out=$row.bytes_out|s$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Email Apps With Threats By Severity</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| stats sum(count) AS count by app severity\n| eval severity_count=mvzip(severity,count,\":\")\n| stats sum(count) as app_count values(severity_count) as severity_count by app\n| sort -app_count\n| head 10\n| mvexpand severity_count\n| rex field=severity_count \"(?&lt;severity&gt;\\w+):(?&lt;count&gt;\\d+)\"\n| xyseries app severity count\n| addtotals\n| sort -Total\n| fields - Total</query>\n        </search>\n        <option name=\"charting.chart\">bar</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.fieldColors\">{\"critical\":#D93F3C,\"high\":#ED8440,\"medium\":#F7BC38,\"low\":#65A637,\"informational\":#6DB7C6}</option>\n        <option name=\"charting.legend.labels\">[critical,high,medium,low,informational]</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_threat` eventtype=\"pan:emails\" OR eventtype=\"pan_email\" app=$click.value$ severity=$click.name2$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <title>Threats By Source Location</title>\n      <map>\n        <search base=\"basesearch\">\n          <query>iplocation client_ip | geostats sum(count) by threat_name</query>\n        </search>\n        <option name=\"drilldown\">none</option>\n        <option name=\"mapping.type\">marker</option>\n      </map>\n    </panel>\n  </row>\n</form>",
"eai:type": "views",
"name": "email_security",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<form version=\"1.1\">\n  <label>File Activity</label>\n  <description></description>\n  <search id=\"basesearch\">\n    <query>| tstats summariesonly=t latest(_time) AS _time, values(log.log_subtype) AS log.log_subtype, values(log.severity) AS log.severity, values(log.app) AS log.app, values(log.user) AS log.user, values(log.threat_name) AS log.threat_name, values(log.file_name) AS log.file_name values(log.bytes_in) AS log.bytes_in, values(log.bytes_out) AS log.bytes_out, values(log.direction) AS log.direction, values(log.src_zone) AS log.src_zone, values(log.dest_zone) AS log.dest_zone, values(log.action) AS log.action, count FROM datamodel=\"pan_firewall\" WHERE nodename=\"log.traffic.end\" OR nodename=\"log.file\" $src_ip$ $dest_ip$ $serial$ $log_subtype$ $direction$ $app$ $vsys$ GROUPBY sourcetype log.serial_number log.session_id log.client_ip log.server_ip | rename log.* AS *</query>\n    <earliest>$time.earliest$</earliest>\n    <latest>$time.latest$</latest>\n  </search>\n  <fieldset autoRun=\"true\" submitButton=\"true\">\n    <input type=\"time\" searchWhenChanged=\"true\" token=\"time\">\n      <label></label>\n      <default>\n        <earliest>-60m</earliest>\n        <latest>now</latest>\n      </default>\n      <!--change>\n        <eval token=\"latest_n\">if('time.latest'==\"now\",now(),tonumber('time.latest'))</eval>\n        <eval token=\"earliest_n\">if('time.latest'==\"now\",relative_time(now(),'time.earliest'),tonumber('time.earliest'))</eval>\n        <eval token=\"timediff\">'latest_n'-'earliest_n'</eval>\n        <eval token=\"span\">case(relative_time('timediff',\"-4h\")&lt;=0, \"30mins\",  relative_time('timediff',\"-3d\")&lt;=0, \"1hour\",  relative_time('timediff',\"-2mon\")&lt;=0, \"1day\",  relative_time('timediff',\"-2mon\")&gt;0, \"1month\")</eval>\n        <eval token=\"spantext\">if(match('span',\"[0-9][0-9]\"), substr('span',0,2)+\" \"+substr('span',3), substr('span',0,1)+\" \"+substr('span',2))</eval>\n        <eval token=\"spantrend\">\"-\"+if(match('span',\"[0-9][0-9]\"), substr('span',0,3), substr('span',0,2))</eval>\n      </change-->\n    </input>\n    <input type=\"text\" token=\"log_subtype\" searchWhenChanged=\"true\">\n      <label>Log Subtype</label>\n      <default></default>\n      <prefix>log.log_subtype=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"serial\">\n      <label>Serial Number</label>\n      <default></default>\n      <prefix>log.serial_number=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"vsys\">\n      <label>Virtual System</label>\n      <default></default>\n      <prefix>log.vsys=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"src_ip\">\n      <label>Source IP</label>\n      <default></default>\n      <prefix>log.src_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"dest_ip\">\n      <label>Destination IP</label>\n      <default></default>\n      <prefix>log.dest_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"app\">\n      <label>Application</label>\n      <default></default>\n      <prefix>log.app=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"dropdown\" token=\"direction\" searchWhenChanged=\"true\">\n      <label>Direction</label>\n      <default></default>\n      <prefix>log.direction=\"</prefix>\n      <suffix>\"</suffix>\n      <choice value=\"\">ANY</choice>\n      <choice value=\"client-to-server\">client-to-server</choice>\n      <choice value=\"server-to-client\">server-to-client</choice>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      <single>\n        <search base=\"basesearch\">\n          <query>| search action=\"blocked\" AND log_subtype=\"file\" | stats sum(count) as count</query>\n        </search>\n        <option name=\"drilldown\">none</option>\n        <option name=\"underLabel\">Blocked</option>\n      </single>\n    </panel>\n    <panel>\n      <single>\n        <search base=\"basesearch\">\n          <query>| search action=\"allowed\" AND log_subtype=\"file\" | stats sum(count) as count</query>\n        </search>\n        <option name=\"drilldown\">none</option>\n        <option name=\"underLabel\">Allowed</option>\n      </single>\n    </panel>\n    <panel>\n      <single>\n        <search base=\"basesearch\">\n          <query>| search log_subtype=\"file\" | stats sum(count)</query>\n        </search>\n        <option name=\"drilldown\">none</option>\n        <option name=\"underLabel\">Total</option>\n      </single>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>File Actions Over Time</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| search log_subtype=\"file\" | timechart count by action</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">column</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <drilldown>\n          <condition match=\"isnotnull('row._span')\">\n            <link target=\"_self\">search?q=`pan_logs` log_subtype=\"file\" action=$click.name2$ earliest=$click.value$ [| stats count | eval latest = $click.value$ %2b 300 | fields latest]&amp;earliest=$earliest$&amp;latest=$latest$</link>\n          </condition>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <title>Bytes Transfered Over Time</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| search bytes_out&gt;0 OR bytes_in&gt;0 | timechart per_minute(bytes_in) as bytes_in,  per_minute(bytes_out) AS bytes_out</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">area</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_logs` log_subtype=\"end\" OR log_subtype=\"file\" $click.name2$&gt;0 earliest=$click.value$ [| stats count | eval latest = $click.value$ %2b 300 | fields latest]&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>File Direction</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| search log_subtype=\"file\" | stats count by direction</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/file_activity?form.direction=$click.value$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <chart>\n        <title>Top Zone File Activity</title>\n        <search base=\"basesearch\">\n          <query>| search log_subtype=\"file\" | eval src_dest_zones = toString(src_zone) + \" to \" + toString(dest_zone) | stats count by src_dest_zones</query>\n        </search>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.drilldown\">none</option>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Top Apps</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>|  stats sum(bytes_in) AS total_bytes_in sum(bytes_out) AS total_bytes_out sum(count) AS count by app  | sort - count</query>\n        </search>\n        <option name=\"drilldown\">row</option>\n        <option name=\"refresh.display\">preview</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/file_activity?form.app=$row.app$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>File Activity</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| where log_subtype=\"file\" | eval time_in_seconds=_time | table _time action app client_ip server_ip user file_name session_id serial_number src_zone dest_zone count | sort -_time</query>\n        </search>\n        <option name=\"count\">20</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">cell</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_logs` action=$row.action$ app=$row.app|s$ client_ip=$row.client_ip$ server_ip=$row.server_ip$ user=$row.user|s$ file_name=$row.file_name|s$ session_id=$row.session_id$ serial_number=$row.serial_number$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n</form>",
"eai:type": "views",
"name": "file_activity",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<form version=\"1.1\">\n  <label>Firewall Configuration</label>\n  <fieldset autoRun=\"true\" submitButton=\"true\">\n    <input type=\"time\" searchWhenChanged=\"true\">\n      <default>\n        <earliest>-60m</earliest>\n        <latest>now</latest>\n      </default>\n    </input>\n    <input type=\"text\" token=\"serial\">\n      <label>Serial Number</label>\n      <default></default>\n      <prefix>log.serial_number=\"</prefix>\n      <suffix>\"</suffix> \n    </input>\n    <input type=\"text\" token=\"admin\">\n      <label>Admin</label>\n      <default></default>\n      <prefix>log.admin=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"host\">\n      <label>Host</label>\n      <default></default>\n      <prefix>host=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"host_name\">\n      <label>Admin IP</label>\n      <default></default>\n      <prefix>log.host_name=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"client\">\n      <label>Admin Type</label>\n      <default></default>\n      <prefix>log.client=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"command\">\n      <label>Command</label>\n      <default></default>\n      <prefix>log.command=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"result\">\n      <label>Result</label>\n      <default></default>\n      <prefix>log.result=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      <table>\n        <title>Latest Events</title>\n        <search>\n          <query>| `pan_tstats` count FROM `node(log.config)` $admin$ $serial$ $host$ $host_name$ $client$ $command$ $result$ `table(_time host log.serial_number log.admin log.host_name log.client log.result log.command log.configuration_path)` | sort -_time</query>\n          <earliest>$earliest$</earliest>\n          <latest>$latest$</latest>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.chart\">area</option>\n        <option name=\"charting.chart.nullValueMode\">connect</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">bottom</option>\n        <option name=\"wrap\">false</option>\n        <option name=\"rowNumbers\">true</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">cell</option>\n        <option name=\"count\">10</option>\n        <drilldown>\n          <link field=\"_time\">\n            <![CDATA[\n            /app/SplunkforPaloAltoNetworks/search?q=`pan_config` _time=$row._time|s$\n        ]]>\n          </link>\n          <link field=\"result\">\n            <![CDATA[\n            /app/SplunkforPaloAltoNetworks/search?q=`pan_config` result=$row.result|s$&earliest=$earliest$&latest=$latest$\n          ]]>\n          </link>\n          <link field=\"serial_number\">\n            <![CDATA[\n            /app/SplunkforPaloAltoNetworks/search?q=`pan_config` serial_number=$row.serial_number|s$&earliest=$earliest$&latest=$latest$\n          ]]>\n          </link>\n          <link field=\"host\">\n            <![CDATA[\n            /app/SplunkforPaloAltoNetworks/search?q=`pan_config` host=$row.host|s$&earliest=$earliest$&latest=$latest$\n          ]]>\n          </link>\n          <link field=\"admin\">\n            <![CDATA[\n            /app/SplunkforPaloAltoNetworks/search?q=`pan_config` admin=$row.admin|s$&earliest=$earliest$&latest=$latest$\n          ]]>\n          </link>\n          <link field=\"host_name\">\n            <![CDATA[\n            /app/SplunkforPaloAltoNetworks/search?q=`pan_config` host_name=$row.host_name|s$&earliest=$earliest$&latest=$latest$\n\t  ]]>\n          </link>\n          <link field=\"client\">\n            <![CDATA[\n            /app/SplunkforPaloAltoNetworks/search?q=`pan_config` client=$row.client|s$&earliest=$earliest$&latest=$latest$\n\t  ]]>\n          </link>\n          <link field=\"configuration_path\">\n            <![CDATA[\n            /app/SplunkforPaloAltoNetworks/search?q=`pan_config` configuration_path=$row.configuration_path|s$\n\t  ]]>\n          </link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <chart>\n        <title>Config Events</title>\n        <search>\n          <query>| `pan_tstats` count FROM `node(log.config)` $serial$ $admin$ $host$ $host_name$ $client$ $command$ $result$ groupby _time log.command | timechart values(count) by log.command</query>\n          <earliest>$earliest$</earliest>\n          <latest>$latest$</latest>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">collapsed</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.chart\">column</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">bottom</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_config` command=$click.name2|s$ [| stats count | eval latest = $click.value$ %2b 300 | fields latest] earliest = $click.value$&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <chart>\n        <title>Configuration Administrators</title>\n        <search>\n          <query>| `pan_tstats` count FROM `node(log.config)` $serial$ $admin$ $host$ $host_name$ $client$ $command$ $result$ groupby _time log.admin | timechart values(count) by log.admin</query>\n          <earliest>$earliest$</earliest>\n          <latest>$latest$</latest>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">collapsed</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.chart\">column</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">bottom</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_config` admin=$click.name2|s$ [| stats count | eval latest = $click.value$ %2b 300 | fields latest] earliest = $click.value$&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <chart>\n        <title>Clients Used</title>\n        <search>\n          <query>| `pan_tstats` count FROM `node(log.config)` $serial$ $admin$ $host$ $host_name$ $client$ $command$ $result$ groupby log.host_name</query>\n          <earliest>$earliest$</earliest>\n          <latest>$latest$</latest>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_config` host_name=$click.value|s$&amp;earliest=$earliest$&amp;latest=$latest$&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <chart>\n        <title>Results</title>\n        <search>\n          <query>| `pan_tstats` count FROM `node(log.config)` $serial$ $admin$ $host$ $host_name$ $client$ $command$ $result$ groupby log.result</query>\n          <earliest>$earliest$</earliest>\n          <latest>$latest$</latest>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_config` result=$click.value|s$&amp;earliest=$earliest$&amp;latest=$latest$&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n</form>",
"eai:type": "views",
"name": "firewall_configuration",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<form version=\"1.1\">\n  <label>Firewall System</label>\n  <fieldset autoRun=\"true\" submitButton=\"true\">\n    <input type=\"time\" searchWhenChanged=\"true\">\n      <default>\n        <earliest>-60m</earliest>\n        <latest>now</latest>\n      </default>\n    </input>\n    <input type=\"text\" token=\"log_subtype\">\n      <label>Log Subtype</label>\n      <default></default>\n      <prefix>log.log_subtype=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"serial_number\">\n      <label>Serial Number</label>\n      <default></default>\n      <prefix>log.serial_number=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"vsys\">\n      <label>Virtual System</label>\n      <default></default>\n      <prefix>log.vsys=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"event_id\">\n      <label>Event ID</label>\n      <default></default>\n      <prefix>log.event_id=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"severity\">\n      <label>Severity</label>\n      <default></default>\n      <prefix>log.severity=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"description\">\n      <label>Description</label>\n      <default></default>\n      <prefix>log.description=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      <table>\n        <title>Latest Events</title>\n        <search>\n          <query>| `pan_tstats` count FROM `node(log.system)` $serial_number$ $vsys$ $description$ $log_subtype$ $severity$ $event_id$ `table(_time log.serial_number log.description log.log_subtype log.severity log.event_id)` | sort -_time\n        </query>\n          <earliest>$earliest$</earliest>\n          <latest>$latest$</latest>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.chart\">area</option>\n        <option name=\"charting.chart.nullValueMode\">connect</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">bottom</option>\n        <option name=\"wrap\">false</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">cell</option>\n        <option name=\"count\">10</option>\n        <option name=\"rowNumbers\">true</option>\n        <drilldown>\n          <link field=\"_time\">\n            <![CDATA[\n            /app/SplunkforPaloAltoNetworks/search?q=`pan_logs` _time=$row._time|s$\n        ]]>\n          </link>\n          <link field=\"serial_number\">\n            <![CDATA[\n            /app/SplunkforPaloAltoNetworks/search?q=`pan_logs` serial_number=$row.serial_number|s$&earliest=$earliest$&latest=$latest$\n          ]]>\n          </link>\n          <link field=\"description\">\n            <![CDATA[\n            /app/SplunkforPaloAltoNetworks/search?q=`pan_logs` description=$row.description|s$&earliest=$earliest$&latest=$latest$\n          ]]>\n          </link>\n          <link field=\"log_subtype\">\n            <![CDATA[\n            /app/SplunkforPaloAltoNetworks/search?q=`pan_logs` log_subtype=$row.log_subtype|s$&earliest=$earliest$&latest=$latest$\n          ]]>\n          </link>\n          <link field=\"severity\">\n            <![CDATA[\n            /app/SplunkforPaloAltoNetworks/search?q=`pan_logs` severity=$row.severity|s$&earliest=$earliest$&latest=$latest$\n\t  ]]>\n          </link>\n          <link field=\"event_id\">\n            <![CDATA[\n            /app/SplunkforPaloAltoNetworks/search?q=`pan_logs` event_id=$row.event_id|s$\n\t  ]]>\n          </link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <chart>\n        <title>System Events Over Time</title>\n        <search>\n          <query>\n          | `pan_tstats` count FROM `node(log.system)` $serial_number$ $vsys$ $description$ $log_subtype$ $severity$ $event_id$ groupby _time log.log_subtype | timechart values(count) by log.log_subtype\n        </query>\n          <earliest>$earliest$</earliest>\n          <latest>$latest$</latest>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">collapsed</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.chart\">column</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">bottom</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_system` log_subtype=$click.name2|s$ [| stats count | eval latest = $click.value$ %2b 300 | fields latest] earliest = $click.value$&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <chart>\n        <title>Severity</title>\n        <search>\n          <query>\n          | `pan_tstats` count FROM `node(log.system)` $serial_number$ $vsys$ $description$ $log_subtype$ $severity$ $event_id$ groupby _time log.severity | timechart values(count) by log.severity\n        </query>\n          <earliest>$earliest$</earliest>\n          <latest>$latest$</latest>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">collapsed</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.chart\">column</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">bottom</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_system` severity=$click.name2|s$ [| stats count | eval latest = $click.value$ %2b 300 | fields latest] earliest = $click.value$&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n</form>",
"eai:type": "views",
"name": "firewall_system",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<form version=\"1.1\" script=\"tooltip.js\" stylesheet=\"tooltip.css\">\n  <label>GlobalProtect</label>\n  <row id=\"tooltip_row\">\n    <html>\n      <div id=\"tooltip_title\">GlobalProtect</div>\n      <div id=\"tooltip_txt\">\n        <h4>Support</h4>\n        <p>This dashboard supports new format GlobalProtect logs from PAN-OS 9.1 and higher.\n        Pre-9.1 system GlobalProtect log support is deprecated so pre-9.1\n        GlobalProtect logs will not show up.</p>\n      </div>\n    </html>\n  </row>\n  <search id=\"basesearch\">\n    <query>| tstats summariesonly=t latest(log.event_id) AS latest_event, values(log.log_subtype) AS log.log_subtype, values(log.src_ip) AS log.src_ip, values(log.result) AS log.result, values(log.client_ip) AS log.client_ip count FROM datamodel=\"pan_firewall\" WHERE nodename=\"log.GlobalProtect\" $src_ip$ $serial$ $vsys$ \"$user|s$\" $object$ groupby _time log.event_id log.user\n      | rename log.* as *</query>\n    <earliest>$time.earliest$</earliest>\n    <latest>$time.latest$</latest>\n  </search>\n  <fieldset autoRun=\"true\" submitButton=\"true\">\n    <input type=\"time\" searchWhenChanged=\"true\" token=\"time\">\n      <label></label>\n      <default>\n        <earliest>-60m</earliest>\n        <latest>now</latest>\n      </default>\n    </input>\n    <input type=\"text\" token=\"serial\">\n      <label>Serial Number</label>\n      <default></default>\n      <prefix>log.serial_number=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"vsys\">\n      <label>Virtual System</label>\n      <default></default>\n      <prefix>log.vsys=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"src_ip\">\n      <label>Source IP</label>\n      <default></default>\n      <prefix>log.src_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"user\">\n      <label>User</label>\n      <default></default>\n      <prefix>log.user=</prefix>\n    </input>\n    <input type=\"text\" token=\"object\">\n      <label>Portal/Gateway</label>\n      <default></default>\n      <suffix>\"</suffix>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      <chart>\n        <title>Connection Events</title>\n        <search base=\"basesearch\">\n          <query>| where log_subtype=\"login\" OR log_subtype=\"logout\" | timechart values(count) by event_id | eval event=event_id </query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.minimumNumber\">1</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">column</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_globalprotect` (log_subtype=\"login\" OR log_subtype=\"logout\") earliest=$click.value$ [| stats count | eval latest = $click.value$ %2b 300 | fields latest] | where ($click.name2|s$==\"Login\" AND log_subtype==\"login\") OR ($click.name2|s$==\"Logout\" AND log_subtyp==\"logout\")&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <chart>\n        <title>Events by User</title>\n        <search base=\"basesearch\">\n          <query>| timechart values(count) by user</query>\n          <earliest>$earliest$</earliest>\n          <latest>$latest$</latest>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">column</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_globalprotect` user=$click.name2|s$ earliest=$click.value$ [| stats count | eval latest = $click.value$ %2b 300 | fields latest]&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <chart>\n        <title>Events by Source IP</title>\n        <search base=\"basesearch\">\n          <query>| stats count(count) by src_ip</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/globalprotect?form.src_ip=$click.value$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <chart>\n        <title>Failed Login by User</title>\n        <search base=\"basesearch\">\n          <query>| where result=\"failure\" | stats count(count) by user</query>\n        </search>\n        <option name=\"wrap\">true</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"count\">10</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_globalprotect` result=\"failure\" user=$click.value|s$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <chart>\n        <title>Disabled Client's</title>\n        <search base=\"basesearch\">\n          <query>| where event_id=\"globalprotectgateway-agent-msg\" AND agent_message=\"Agent Disable\" | stats count(count) by user</query>\n        </search>\n        <option name=\"wrap\">true</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"count\">10</option>\n        <option name=\"colorBy\">value</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"numberPrecision\">0</option>\n        <option name=\"showSparkline\">1</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trendColorInterpretation\">standard</option>\n        <option name=\"trendDisplayMode\">absolute</option>\n        <option name=\"useColors\">0</option>\n        <option name=\"useThousandSeparators\">1</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_globalprotect` event_id=\"globalprotectgateway-agent-msg\" agent_message=\"Agent Disable\" user=$click.value|s$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <chart>\n        <title>Connected by User</title>\n        <search base=\"basesearch\">\n          <query>| where log_subtype=\"connected\" | stats count(count) by user | `top(20)`</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">bar</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">none</option>\n        <option name=\"wrap\">true</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_globalprotect` log_subtype=\"connected\" user=$click.value|s$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <single>\n        <title>Total Users Logged In</title>\n        <search base=\"basesearch\">\n          <query>| where log_subtype=\"connected\" OR event_id=\"logout\" | search latest_event=\"gateway-connected\" | stats count(count) by user | stats dc(user)</query>\n        </search>\n        <option name=\"colorBy\">value</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"numberPrecision\">0</option>\n        <option name=\"rangeColors\">[\"0x65a637\",\"0x6db7c6\",\"0xf7bc38\",\"0xf58f39\",\"0xd93f3c\"]</option>\n        <option name=\"rangeValues\">[0,30,70,100]</option>\n        <option name=\"showSparkline\">1</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trendColorInterpretation\">standard</option>\n        <option name=\"trendDisplayMode\">absolute</option>\n        <option name=\"trendInterval\">auto</option>\n        <option name=\"underLabel\">Users</option>\n        <option name=\"useColors\">0</option>\n        <option name=\"useThousandSeparators\">1</option>\n      </single>\n    </panel>\n    <panel>\n      <table>\n        <title>Users Logged In</title>\n        <search base=\"basesearch\">\n          <query>| where log_subtype=\"connected\" OR log_subtype=\"logout\" | search latest_event=\"gateway-connected\" | stats count(count) by user | table user</query>\n        </search>\n        <html tokens=\"true\">\n          <div class=\"footnote\">\n            <small>*Based on login events without a logout event for each user within the timeframe</small>\n          </div>\n        </html>\n        <option name=\"count\">10</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">cell</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"wrap\">true</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/globalprotect?form.user=$click.value|s$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <map>\n        <title>User Location by Source IP</title>\n        <search base=\"basesearch\">\n          <query>| where log_subtype=\"connected\" OR log_subtype=\"logout\" | iplocation src_ip | geostats count by user</query>\n        </search>\n        <option name=\"drilldown\">all</option>\n        <option name=\"mapping.choroplethLayer.colorBins\">5</option>\n        <option name=\"mapping.choroplethLayer.colorMode\">auto</option>\n        <option name=\"mapping.choroplethLayer.maximumColor\">0xDB5800</option>\n        <option name=\"mapping.choroplethLayer.minimumColor\">0x2F25BA</option>\n        <option name=\"mapping.choroplethLayer.neutralPoint\">0</option>\n        <option name=\"mapping.choroplethLayer.shapeOpacity\">0.75</option>\n        <option name=\"mapping.choroplethLayer.showBorder\">1</option>\n        <option name=\"mapping.data.maxClusters\">100</option>\n        <option name=\"mapping.map.center\">(37.72,-113.47)</option>\n        <option name=\"mapping.map.panning\">1</option>\n        <option name=\"mapping.map.scrollZoom\">0</option>\n        <option name=\"mapping.map.zoom\">3</option>\n        <option name=\"mapping.markerLayer.markerMaxSize\">50</option>\n        <option name=\"mapping.markerLayer.markerMinSize\">10</option>\n        <option name=\"mapping.markerLayer.markerOpacity\">0.8</option>\n        <option name=\"mapping.showTiles\">1</option>\n        <option name=\"mapping.tileLayer.maxZoom\">7</option>\n        <option name=\"mapping.tileLayer.minZoom\">0</option>\n        <option name=\"mapping.tileLayer.tileOpacity\">1</option>\n        <option name=\"mapping.type\">marker</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_globalprotect` user=$click.name$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </map>\n    </panel>\n  </row>\n</form>",
"eai:type": "views",
"name": "globalprotect",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<dashboard version=\"1.1\">\n  <label>IoT Activity</label>\n  <row>\n    <panel>\n      <single>\n        <search>\n          <query>`pan_iot_device` | stats dc(MAC)</query>\n          <earliest>-1d@d</earliest>\n          <latest>now</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"colorBy\">value</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"underLabel\">Monitored Devices</option>\n        <option name=\"numberPrecision\">0</option>\n        <option name=\"rangeColors\">[\"0x53a051\", \"0x0877a6\", \"0xf8be34\", \"0xf1813f\", \"0xdc4e41\"]</option>\n        <option name=\"rangeValues\">[0,30,70,100]</option>\n        <option name=\"showSparkline\">1</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <option name=\"trendColorInterpretation\">standard</option>\n        <option name=\"trendDisplayMode\">absolute</option>\n        <option name=\"unitPosition\">after</option>\n        <option name=\"useColors\">0</option>\n        <option name=\"useThousandSeparators\">1</option>\n      </single>\n    </panel>\n    <panel>\n      <single>\n        <search>\n          <query>`pan_iot_device` profile_type=\"IoT\" | stats dc(MAC)</query>\n          <earliest>-1d@d</earliest>\n          <latest>now</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"colorBy\">value</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"underLabel\">IoT Devices</option>\n        <option name=\"numberPrecision\">0</option>\n        <option name=\"rangeColors\">[\"0x53a051\", \"0x0877a6\", \"0xf8be34\", \"0xf1813f\", \"0xdc4e41\"]</option>\n        <option name=\"rangeValues\">[0,30,70,100]</option>\n        <option name=\"showSparkline\">1</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <option name=\"trendColorInterpretation\">standard</option>\n        <option name=\"trendDisplayMode\">absolute</option>\n        <option name=\"unitPosition\">after</option>\n        <option name=\"useColors\">0</option>\n        <option name=\"useThousandSeparators\">1</option>\n      </single>\n    </panel>\n    <panel>\n      <single>\n        <search>\n          <query>`pan_iot_device` | stats dc(Applications)</query>\n          <earliest>-1d@d</earliest>\n          <latest>now</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"colorBy\">value</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"underLabel\">Applications</option>\n        <option name=\"numberPrecision\">0</option>\n        <option name=\"rangeColors\">[\"0x53a051\", \"0x0877a6\", \"0xf8be34\", \"0xf1813f\", \"0xdc4e41\"]</option>\n        <option name=\"rangeValues\">[0,30,70,100]</option>\n        <option name=\"showSparkline\">1</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <option name=\"trendColorInterpretation\">standard</option>\n        <option name=\"trendDisplayMode\">absolute</option>\n        <option name=\"unitPosition\">after</option>\n        <option name=\"useColors\">0</option>\n        <option name=\"useThousandSeparators\">1</option>\n      </single>\n    </panel>\n    <panel>\n      <single>\n        <search>\n          <query>`pan_iot_device` | stats dc(subnet)</query>\n          <earliest>-1d@d</earliest>\n          <latest>now</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"colorBy\">value</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"underLabel\">Subnets</option>\n        <option name=\"numberPrecision\">0</option>\n        <option name=\"rangeColors\">[\"0x53a051\", \"0x0877a6\", \"0xf8be34\", \"0xf1813f\", \"0xdc4e41\"]</option>\n        <option name=\"rangeValues\">[0,30,70,100]</option>\n        <option name=\"showSparkline\">1</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <option name=\"trendColorInterpretation\">standard</option>\n        <option name=\"trendDisplayMode\">absolute</option>\n        <option name=\"unitPosition\">after</option>\n        <option name=\"useColors\">0</option>\n        <option name=\"useThousandSeparators\">1</option>\n      </single>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <chart>\n        <title>Devices by Profile Vertical</title>\n        <search>\n          <query>`pan_iot_device` | stats count by profile_vertical</query>\n          <earliest>-1d@d</earliest>\n          <latest>now</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.abbreviation\">none</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.abbreviation\">none</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.abbreviation\">none</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">none</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.mode\">standard</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <option name=\"charting.lineWidth\">2</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n      </chart>\n    </panel>\n    <panel>\n      <table>\n        <title>Devices by Profile Vertical</title>\n        <search>\n          <query>`pan_iot_device` | dedup MAC | stats dc(MAC) as Devices dc(profile) as Profiles dc(category) as Categories by profile_vertical</query>\n          <earliest>-1d@d</earliest>\n          <latest>now</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">100</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <table>\n        <title>New Devices Seen in the Last 24 hours</title>\n        <search>\n          <query>| set diff [search `pan_iot_device` dc(MAC) earliest=-0d@d latest=now | table hostname profile ip_address MAC last_activity] [search `pan_iot_device` dc(MAC) earliest=-1d@d latest=-0d@d | table hostname profile ip_address MAC last_activity] | dedup MAC</query>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">20</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">row</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n        <drilldown>\n          <link target=\"_self\">search?q=%60pan_iot_device%60%20MAC%3D$row.MAC$%20%7C%20dedup%20MAC&amp;earliest=0&amp;latest=</link>\n\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n</dashboard>",
"eai:type": "views",
"name": "iot_activity",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<form version=\"1.1\">\n  <label>IoT Security</label>\n  <fieldset autoRun=\"true\" submitButton=\"true\">\n    <input type=\"time\" searchWhenChanged=\"true\" token=\"time\">\n      <default>\n        <earliest>-24h@h</earliest>\n        <latest>now</latest>\n      </default>\n    </input>\n    <input type=\"multiselect\" token=\"risk_level\">\n      <label>Risk Level</label>\n      <choice value=\"Critical\">Critical</choice>\n      <choice value=\"High\">High</choice>\n      <choice value=\"Medium\">Medium</choice>\n      <choice value=\"Low\">Low</choice>\n      <choice value=\"Info\">Info</choice>\n      <default>*</default>\n      <valuePrefix>risk_level=\"</valuePrefix>\n      <valueSuffix>\"</valueSuffix>\n      <delimiter> OR  </delimiter>\n      <prefix>(</prefix>\n      <suffix>)</suffix>\n    </input>\n    <input type=\"text\" token=\"name\">\n      <label>Vulnerability Name</label>\n      <default></default>\n      <prefix>name=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"vulnerability_name\">\n      <label>Vulnerability CVE</label>\n      <default></default>\n      <prefix>vulnerability_name=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      <single>\n        <search>\n          <query>`pan_iot_alert` | stats dc(id)</query>\n          <earliest>$time.earliest$</earliest>\n          <latest>$time.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"colorBy\">value</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"numberPrecision\">0</option>\n        <option name=\"rangeColors\">[\"0x53a051\", \"0x0877a6\", \"0xf8be34\", \"0xf1813f\", \"0xdc4e41\"]</option>\n        <option name=\"rangeValues\">[0,30,70,100]</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"showSparkline\">1</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <option name=\"trendColorInterpretation\">standard</option>\n        <option name=\"trendDisplayMode\">absolute</option>\n        <option name=\"underLabel\">Active Alerts</option>\n        <option name=\"unitPosition\">after</option>\n        <option name=\"useColors\">0</option>\n        <option name=\"useThousandSeparators\">1</option>\n      </single>\n    </panel>\n    <panel>\n      <single>\n        <search>\n          <query>`pan_iot_vulnerability` | stats dc(zb_ticketid)</query>\n          <earliest>$time.earliest$</earliest>\n          <latest>$time.latest$</latest>\n        </search>\n        <option name=\"colorBy\">value</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"numberPrecision\">0</option>\n        <option name=\"rangeColors\">[\"0x53a051\", \"0x0877a6\", \"0xf8be34\", \"0xf1813f\", \"0xdc4e41\"]</option>\n        <option name=\"rangeValues\">[0,30,70,100]</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"showSparkline\">1</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <option name=\"trendColorInterpretation\">standard</option>\n        <option name=\"trendDisplayMode\">absolute</option>\n        <option name=\"underLabel\">Vulnerabilities</option>\n        <option name=\"unitPosition\">after</option>\n        <option name=\"useColors\">0</option>\n        <option name=\"useThousandSeparators\">1</option>\n      </single>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Alerts</title>\n      <chart>\n        <search>\n          <query>`pan_iot_alert` | stats count by _time id category | timechart count by category</query>\n          <earliest>$time.earliest$</earliest>\n          <latest>$time.latest$</latest>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.chart\">column</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.drilldown\">none</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisEnd</option>\n        <option name=\"charting.legend.placement\">bottom</option>\n        <option name=\"refresh.display\">progressbar</option>\n      </chart>\n    </panel>\n    <panel>\n      <table>\n        <search>\n          <query>`pan_iot_alert` | stats count by id category | stats count by category | sort -count</query>\n          <earliest>$time.earliest$</earliest>\n          <latest>$time.latest$</latest>\n        </search>\n        <option name=\"drilldown\">row</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"totalsRow\">true</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Vulnerabilities</title>\n      <table>\n        <search>\n          <query>`pan_iot_vulnerability` $risk_level$ $name$ $vulnerability_name$ | table _time name display_profile_category risk_level vulnerability_name ip customerId | eval \"more_info\"=\"Details \u21aa\" | sort -date</query>\n          <earliest>$time.earliest$</earliest>\n          <latest>$time.latest$</latest>\n        </search>\n        <option name=\"drilldown\">row</option>\n        <option name=\"refresh.display\">progressbar</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n        <format type=\"color\" field=\"risk_level\">\n          <colorPalette type=\"map\">{\"Critical\":#D93F3C,\"High\":#ED8440,\"Medium\":#F7BC38,\"Low\":#65A637,\"Info\":#6DB7C6}</colorPalette>\n        </format>\n        <fields>[\"_time\",\"name\",\"display_profile_category\",\"vulnerability_name\",\"risk_level\",\"ip\",\"more_info\"]</fields>\n        <drilldown>\n          <condition field=\"more_info\">\n            <link target=\"_blank\">https://$row.customerId$.iot.paloaltonetworks.com/guardian/risks/vulnerabilities/$row.vulnerability_name$</link>\n          </condition>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n</form>",
"eai:type": "views",
"name": "iot_security",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<form version=\"1.1\" script=\"tooltip.js\" stylesheet=\"tooltip.css\">\n  <label>Malware</label>\n  <search id=\"basesearch\">\n    <query>| tstats summariesonly=t latest(_time) AS _time, values(log.log_subtype) AS log.log_subtype, values(log.severity) AS log.severity, values(log.app) AS log.app, values(log.user) AS log.user, values(log.threat_name) AS log.threat_name, values(log.file_name) AS log.file_name, count FROM datamodel=\"pan_firewall\" WHERE nodename=\"log.threat\" OR (nodename=\"log.wildfire\" AND nodename!=\"log.wildfire.benign\") $log_subtype$ $severity$ $serial$ $vsys$ GROUPBY sourcetype log.serial_number log.session_id log.client_ip log.server_ip log.direction log.action\n| append\n    [| tstats summariesonly=t count FROM datamodel=\"pan_firewall\" WHERE nodename=\"log.correlation\" $log_subtype$ $severity$ $serial$ $vsys$ $src_ip$ $dest_ip$ $file_name$ \"$user|s$\" $app$ GROUPBY _time span=1s sourcetype log.log_subtype log.severity log.src_ip log.user log.object\n    | rename log.src_ip AS log.client_ip | rename log.object AS log.threat_name ]\n| rename log.* AS *\n| eval severity=case(severity==\"critical\",\"critical\", severity==\"high\",\"high\", severity==\"medium\",\"medium\", severity==\"low\",\"low\", severity==\"informational\",\"informational\")\n| eval victim_ip=if(isnull(direction) OR direction=\"client-to-server\", server_ip, client_ip)</query>\n    <earliest>$time.earliest$</earliest>\n    <latest>$time.latest$</latest>\n  </search>\n  <fieldset autoRun=\"true\" submitButton=\"true\">\n    <input type=\"time\" searchWhenChanged=\"true\" token=\"time\">\n      <label></label>\n      <default>\n        <earliest>-60m</earliest>\n        <latest>now</latest>\n      </default>\n    </input>\n    <input type=\"text\" token=\"log_subtype\" searchWhenChanged=\"true\">\n      <label>Log Subtype</label>\n      <default></default>\n      <prefix>log.log_subtype=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"serial\">\n      <label>Serial Number</label>\n      <default></default>\n      <prefix>log.serial_number=\"</prefix>\n      <suffix>\"</suffix> \n    </input>\n    <input type=\"text\" token=\"vsys\">\n      <label>Virtual System</label>\n      <default></default>\n      <prefix>log.vsys=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"src_ip\">\n      <label>Source IP</label>\n      <default></default>\n      <prefix>log.src_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"dest_ip\">\n      <label>Destination IP</label>\n      <default></default>\n      <prefix>log.dest_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"file_name\">\n      <label>Filename</label>\n      <default></default>\n      <prefix>log.file_name=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"user\">\n      <label>User</label>\n      <default></default>\n      <prefix>log.user=</prefix>\n    </input>\n    <input type=\"dropdown\" token=\"severity\">\n      <label>Severity</label>\n      <default>*</default>\n      <prefix>log.severity=\"</prefix>\n      <suffix>\"</suffix>\n      <choice value=\"low\">Low</choice>\n      <choice value=\"medium\">Medium</choice>\n      <choice value=\"high\">High</choice>\n      <choice value=\"critical\">Critical</choice>\n      <choice value=\"*\">All</choice>\n      <fieldForLabel>severity</fieldForLabel>\n      <fieldForValue>severity</fieldForValue>\n      <initialValue>*</initialValue>\n    </input>\n    <input type=\"text\" token=\"app\">\n      <label>Application</label>\n      <default></default>\n      <prefix>log.app=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"dropdown\" token=\"action\">\n      <label>Action</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <prefix>log.action=\"</prefix>\n      <suffix>\"</suffix>\n      <fieldForLabel>action</fieldForLabel>\n      <fieldForValue>action</fieldForValue>\n      <search>\n        <query>| inputlookup pan_vendor_actions.csv \n| fields action\n| dedup action\n| sort action</query>\n      </search>\n    </input>\n  </fieldset>\n  <row id=\"tooltip_row\">\n    <panel>\n      <html>\n      <div id=\"tooltip_title\">Malware</div>\n      <div id=\"tooltip_txt\">\n        <h4>Overview</h4>\n        <p>The Malware dashboard displays malware related information across all Palo Alto Networks products.</p>\n        <h4>Products Shown</h4>\n        <ul>\n          <li>Firewall or Panorama</li>\n          <li>WildFire</li>\n          <li>AutoFocus</li>\n          <li>MineMeld</li>\n        </ul>\n      </div>\n    </html>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Malware Families and Campaigns</title>\n      <table>\n        <search>\n          <query>| tstats summariesonly=t values(log.log_subtype) AS log.log_subtype, values(log.file_hash) AS log.file_hash, values(log.url) AS log.url, values(log.dest_name) AS log.dest_name, count FROM datamodel=\"pan_firewall\" GROUPBY `session`\n| rename log.* as *\n| lookup minemeldfeeds_lookup indicator AS client_ip OUTPUT value.autofocus_tags AS client_autofocus_tags\n| lookup minemeldfeeds_lookup indicator AS server_ip OUTPUT value.autofocus_tags AS server_autofocus_tags\n| lookup minemeldfeeds_lookup indicator AS file_hash OUTPUT value.autofocus_tags AS file_autofocus_tags\n| lookup minemeldfeeds_lookup indicator AS url OUTPUT value.autofocus_tags AS url_autofocus_tags\n| lookup minemeldfeeds_lookup indicator AS dest_name OUTPUT value.autofocus_tags AS domain_autofocus_tags\n| eval autofocus_tags=mvappend(client_autofocus_tags,server_autofocus_tags,file_autofocus_tags,url_autofocus_tags,domain_autofocus_tags)\n| fillnull value=\"\" autofocus_tags\n| mvexpand autofocus_tags\n| lookup autofocus_tag_lookup aftag:public_tag_name AS autofocus_tags OUTPUT aftag:tag_class aftag:aliases aftag:tag_name aftag:tagstatus\n| search (aftag:tag_class=\"malware_family\" OR aftag:tag_class=\"campaign\") AND aftag:tagstatus=\"enable\"\n| makemv delim=\" \" aftag:aliases\n| rename aftag:* AS *\n| stats values(aliases) AS aliases, sum(count) AS count by tag_name tag_class\n| table tag_name aliases tag_class count</query>\n          <earliest>$time.earliest$</earliest>\n          <latest>$time.latest$</latest>\n        </search>\n        <option name=\"drilldown\">cell</option>\n      </table>\n    </panel>\n    <panel>\n      <title>Top Domains Serving Malware</title>\n      <table>\n        <search>\n          <query>| tstats summariesonly=t values(log.dest_name) AS log.dest_name, count FROM datamodel=\"pan_firewall\" WHERE (nodename=\"log.traffic\" OR nodename=\"log.url\") AND $log_subtype$ $severity$ $serial$ $vsys$ $src_ip$ $dest_ip$ $file_name$ \"$user|s$\" $app$ log.http_category=\"malware*\" GROUPBY log.dest_ip\n| rename log.* AS *\n| stats sum(count) AS count by dest_name dest_ip\n| sort -count</query>\n          <earliest>$time.earliest$</earliest>\n          <latest>$time.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">20</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">cell</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_logs` (log_subtype=\"end\" OR log_subtype=\"url\") AND http_category=\"malware*\" dest_name=$row.dest_name|s$ dest_ip=$row.dest_ip$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Malware Delivery and Installation</title>\n      <table>\n        <search>\n          <query>| tstats summariesonly=t count FROM datamodel=\"pan_firewall\" WHERE nodename=\"log.threat\" AND (log.log_subtype=\"virus\" OR log.log_subtype=\"wildfire-virus\") $log_subtype$ $severity$ $serial$ $vsys$ $src_ip$ $dest_ip$ $file_name$ \"$user|s$\" $app$ GROUPBY log.user log.threat_name log.src_ip log.dest_ip log.vendor_action | rename log.* as *</query>\n          <earliest>$time.earliest$</earliest>\n          <latest>$time.latest$</latest>\n        </search>\n        <option name=\"drilldown\">cell</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_logs` log_subtype=\"virus\" OR log_subtype=\"wildfire-virus\" user=$row.user|s$ threat_name=$row.threat_name|s$ src_ip=$row.src_ip|s$ dest_ip=$row.dest_ip|s$ vendor_action=$row.vendor_action|s$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n    <panel>\n      <title>Command and Control Traffic</title>\n      <table>\n        <search>\n          <query>| tstats summariesonly=t count FROM datamodel=\"pan_firewall\" WHERE nodename=\"log.threat.spyware\" $log_subtype$ $severity$ $serial$ $vsys$ $src_ip$ $dest_ip$ $file_name$ \"$user|s$\" $app$ GROUPBY log.user log.threat_name log.src_ip log.dest_ip log.vendor_action | rename log.* as * \n| sort -count</query>\n          <earliest>$time.earliest$</earliest>\n          <latest>$time.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">20</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">cell</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_threat` log_subtype=\"spyware\" user=$row.user|s$ threat_name=$row.threat_name|s$ src_ip=$row.src_ip|s$ dest_ip=$row.dest_ip|s$ vendor_action=$row.vendor_action|s$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Malware Events by Product</title>\n      <chart>\n        <search>\n          <query>| tstats count from datamodel=\"pan_firewall\" WHERE nodename=\"log.wildfire.malicious\" OR log.http_category=\"malware*\" $log_subtype$ $severity$ $serial$ $vsys$ $src_ip$ $dest_ip$ $file_name$ \"$user|s$\" $app$ by product</query>\n          <earliest>$time.earliest$</earliest>\n          <latest>$time.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n      </chart>\n    </panel>\n    <panel>\n      <title>Malware Events by Action</title>\n      <chart>\n        <search>\n          <query>| tstats summariesonly=t count FROM datamodel=\"pan_firewall\" WHERE log.http_category=\"mal*\" $log_subtype$ $severity$ $serial$ $vsys$ $src_ip$ $dest_ip$ $file_name$ \"$user|s$\" $app$ by log.action | rename log.action as action | stats sum(count) as count by action</query>\n          <earliest>$time.earliest$</earliest>\n          <latest>$time.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/malware?form.action=$click.value$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n</form>",
"eai:type": "views",
"name": "malware",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<form version=\"1.1\" script=\"tooltip.js\" stylesheet=\"tooltip.css\">\n  <label>Network Security</label>\n  <search id=\"basesearch\">\n    <query>| tstats summariesonly=t values(log.log_subtype) AS log.log_subtype, values(log.severity) AS log.severity, values(log.app) AS log.app, values(log.user) AS log.user, values(log.threat_name) AS log.threat_name, values(log.file_name) AS log.file_name, count FROM datamodel=\"pan_firewall\" WHERE nodename=\"log.threat\" OR (nodename=\"log.wildfire.malicious\") OR nodename=\"log.data\" $log_subtype$ $severity$ $app$ $dest_ip$ $serial$ $threat_name$ $vsys$ GROUPBY _time sourcetype log.serial_number log.session_id log.client_ip log.server_ip log.direction log.action log.src_zone log.dest_zone | rename log.* AS *\n    </query>\n    <earliest>$time.earliest$</earliest>\n    <latest>$time.latest$</latest>\n  </search>\n  <search id=\"correlation\">\n    <query>| tstats summariesonly=t count FROM datamodel=\"pan_firewall\" WHERE nodename=\"log.correlation\" GROUPBY log.severity log.threat_category log.threat_name | rename log.* AS *</query>\n    <earliest>$time.earliest$</earliest>\n    <latest>$time.latest$</latest>\n  </search>\n  <fieldset autoRun=\"true\" submitButton=\"true\">\n    <input type=\"time\" searchWhenChanged=\"true\" token=\"time\">\n      <label></label>\n      <default>\n        <earliest>-60m</earliest>\n        <latest>now</latest>\n      </default>\n    </input>\n    <input type=\"text\" token=\"log_subtype\">\n      <label>Log Subtype</label>\n      <default></default>\n      <prefix>log.log_subtype=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"serial\">\n      <label>Serial Number</label>\n      <default></default>\n      <prefix>log.serial_number=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"vsys\">\n      <label>Virtual System</label>\n      <default></default>\n      <prefix>log.vsys=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"src_ip\">\n      <label>Source IP</label>\n      <default></default>\n      <prefix>log.src_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"dest_ip\">\n      <label>Destination IP</label>\n      <default></default>\n      <prefix>log.dest_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"threat_name\">\n      <label>Threat</label>\n      <default></default>\n      <prefix>log.threat_name=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"severity\">\n      <label>Severity</label>\n      <default></default>\n      <prefix>log.severity=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"app\">\n      <label>Application</label>\n      <default></default>\n      <prefix>log.app=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n  </fieldset>\n  <row id=\"tooltip_row\">\n    <panel>\n      <html>\n        <div id=\"tooltip_title\">Network Security</div>\n        <div id=\"tooltip_txt\">\n          <h4>Overview</h4>\n          <p>Network Security data is displayed from Palo Alto Networks next-generation firewalls and Panorama.</p>\n          <h4>Products Shown</h4>\n          <ul>\n            <li>Firewall or Panorama</li>\n          </ul>\n        </div>\n      </html>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Top Correlation Events</title>\n      <table>\n        <search base=\"correlation\">\n          <query>| stats sum(count) AS count by threat_name threat_category severity</query>\n        </search>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_threat` log_subtype=correlation evidence=$row.threat_name|s$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Top 20 Vulnerability Events</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| search log_subtype=\"vulnerability\" | stats sum(count) AS count by threat_name severity\n| sort 20 -count</query>\n        </search>\n        <option name=\"drilldown\">row</option>\n        <option name=\"wrap\">false</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_threat` $click.name$=\"$click.value$\"&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n    <panel>\n      <title>Top 20 Virus and Malware Events</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| search log_subtype=\"virus\" OR log_subtype=\"*virus*\" | stats count by file_name log_subtype user client_ip server_ip | sort - count</query>\n        </search>\n        <option name=\"drilldown\">row</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_threat` log_subtype=\"virus\" OR log_subtype=\"*virus*\" file_name=$row.file_name|s$ user=$row.user|s$ client_ip=$row.client_ip|s$ server_ip=$row.server_ip|s$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>DNS Sinkhole</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>\n            |  search vendor_action=\"sinkhole\" | table client_ip user file_name src_zone dest_zone\n            | sort 20 -count\n          </query>\n        </search>\n        <option name=\"count\">20</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">cell</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_logs` vendor_action=\"sinkhole\" client_ip=$row.client_ip|s$ user=$row.user|s$ file_name=$row.file_name|s$ src_zone=$src_zone|s$ dest_zone=$dest_zone|s$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Top 10 Apps With Threats By Severity</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| stats sum(count) AS count by app severity\n| eval severity_count=mvzip(severity,count,\":\")\n| stats sum(count) as app_count values(severity_count) as severity_count by app\n| sort -app_count\n| head 10\n| mvexpand severity_count\n| rex field=severity_count \"(?&lt;severity&gt;\\w+):(?&lt;count&gt;\\d+)\"\n| xyseries app severity count\n| addtotals\n| sort -Total\n| fields - Total</query>\n        </search>\n        <option name=\"charting.chart\">bar</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.fieldColors\">{\"critical\":#D93F3C,\"high\":#ED8440,\"medium\":#F7BC38,\"low\":#65A637,\"informational\":#6DB7C6}</option>\n        <option name=\"charting.legend.labels\">[critical,high,medium,low,informational]</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/network_security?form.app=$click.value$&amp;form.severity=$click.name2$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <title>Threats By Source Location</title>\n      <map>\n        <search base=\"basesearch\">\n          <query>| iplocation client_ip | geostats sum(count) by log_subtype</query>\n        </search>\n        <option name=\"drilldown\">all</option>\n        <option name=\"mapping.type\">marker</option>\n      </map>\n    </panel>\n  </row>\n</form>",
"eai:type": "views",
"name": "network_security",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<dashboard version=\"1.1\" script=\"tooltip.js\" stylesheet=\"tooltip.css\">\n  <label>Realtime Event Feed</label>\n  <description>Real-time 5 minute window</description>\n  <search id=\"baseSearch\">\n    <query>`pan_logs` | fillnull value=\"\" host dvc sourcetype log_subtype action category serial_number | stats count by _time host dvc serial_number sourcetype eventtype log_subtype action category</query>\n    <earliest>rt-5m</earliest>\n    <latest>rt</latest>\n  </search>\n  <row id=\"tooltip_row\">\n    <panel>\n      <html>\n        <div id=\"tooltip_title\">Realtime Event Feed</div>\n        <div id=\"tooltip_txt\">\n          <h4>Overview</h4>\n          <p>Use this dashboard to see logs ingested by Splunk at the current moment. This is a good troubleshooting tool to see if logs are coming in from the right sources. Some customers prefer not to allow real-time searches in Splunk. Click 'More...' below to learn how to disable real-time searches.</p>\n        </div>\n      </html>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <single>\n        <search base=\"baseSearch\">\n          <query>| stats sum(count) as count</query>\n        </search>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"rangeColors\">[\"0xd93f3c\",\"0x000000\"]</option>\n        <option name=\"rangeValues\">[0]</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.size\">large</option>\n        <option name=\"underLabel\">NGFW Logs</option>\n        <option name=\"useColors\">1</option>\n      </single>\n    </panel>\n    <panel>\n      <single>\n        <search base=\"baseSearch\">\n          <query>| search eventtype=\"pan_traps\" | stats sum(count) AS count</query>\n        </search>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"rangeColors\">[\"0xd93f3c\",\"0x000000\"]</option>\n        <option name=\"rangeValues\">[0]</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.size\">large</option>\n        <option name=\"underLabel\">Endpoint Logs</option>\n        <option name=\"useColors\">1</option>\n      </single>\n    </panel>\n    <panel>\n      <single>\n        <search base=\"baseSearch\">\n          <query>| search eventtype=\"pan_aperture\" | stats sum(count) AS count</query>\n        </search>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"rangeColors\">[\"0xd93f3c\",\"0x000000\"]</option>\n        <option name=\"rangeValues\">[0]</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.size\">large</option>\n        <option name=\"underLabel\">Aperture Logs</option>\n        <option name=\"useColors\">1</option>\n      </single>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <single>\n        <search base=\"baseSearch\">\n          <query>| search serial_number=* | stats dc(serial_number)</query>\n        </search>\n        <option name=\"colorBy\">trend</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"rangeColors\">[\"0xd93f3c\",\"0x000000\"]</option>\n        <option name=\"rangeValues\">[0]</option>\n        <option name=\"showSparkline\">0</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.size\">large</option>\n        <option name=\"trendDisplayMode\">absolute</option>\n        <option name=\"underLabel\">Next-generation Firewalls Reporting</option>\n        <option name=\"useColors\">1</option>\n      </single>\n    </panel>\n    <panel>\n      <single>\n        <search base=\"baseSearch\">\n          <query>| search eventtype=\"pan_traps\" | stats dc(src)</query>\n        </search>\n        <option name=\"colorBy\">trend</option>\n        <option name=\"colorMode\">none</option>\n        <option name=\"drilldown\">none</option>\n        <option name=\"rangeColors\">[\"0xd93f3c\",\"0x000000\"]</option>\n        <option name=\"rangeValues\">[0]</option>\n        <option name=\"showSparkline\">0</option>\n        <option name=\"showTrendIndicator\">1</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.size\">large</option>\n        <option name=\"trendDisplayMode\">absolute</option>\n        <option name=\"underLabel\">Endpoint Security Managers Reporting</option>\n        <option name=\"useColors\">1</option>\n      </single>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Event Types</title>\n      <chart>\n        <search base=\"baseSearch\">\n          <query>| search sourcetype=\"pan:*\" log_subtype=\"*\"\n| timechart span=10s sum(count) AS count BY log_subtype</query>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.text\">Events</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.chart\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <option name=\"height\">241</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/search?q=`pan_logs` sourcetype=\"pan:*\" log_subtype=$click.name2|s$&amp;earliest=-5m&amp;latest=now</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Logs by host</title>\n      <chart>\n        <search base=\"baseSearch\">\n          <query>| stats sum(count) AS count BY host</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY2.visibility\">collapsed</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">none</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">small</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_logs` | search dvc=\"$click.value$\"&amp;earliest=rt-5m&amp;latest=rt</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <title>Logs by device</title>\n      <chart>\n        <search base=\"baseSearch\">\n          <query>| timechart span=10s sum(count) AS count BY dvc</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY2.visibility\">collapsed</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">area</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">small</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_logs` | search dvc_host=\"$click.name2$\"&amp;earliest=rt-5m&amp;latest=rt</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Event Feed</title>\n      <event>\n        <search base=\"baseSearch\">\n          <query>| head 100</query>\n        </search>\n        <option name=\"list.drilldown\">none</option>\n        <option name=\"raw.drilldown\">none</option>\n        <option name=\"type\">list</option>\n      </event>\n    </panel>\n  </row>\n</dashboard>",
"eai:type": "views",
"name": "realtime_event_feed",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<form version=\"1.1\" script=\"tooltip.js\" stylesheet=\"tooltip.css\">\n  <label>SaaS Activity</label>\n  <description></description>\n  <search id=\"basesearch\">\n    <query>| tstats summariesonly=t prestats=t values(sourcetype), values(log.log_subtype), values(log.app:is_sanctioned_saas), values(log.app:risk), values(log.app:category), values(log.app:subcategory), values(log.bytes_in), values(log.bytes_out), values(log.action), values(log.file_name) count FROM datamodel=\"pan_firewall\" WHERE nodename=\"log.traffic.end\" log.app:is_saas=\"yes\" $src_ip$ $dst_ip$ $serial_number$ $virtual_system$ \"$user|s$\" $app$ $category$ $action$ GROUPBY _time log.client_ip log.user log.app\n| tstats summariesonly=t prestats=t append=t values(sourcetype), values(log.log_subtype), values(log.action), values(log.object), values(log.object_path), values(log.severity), values(log.signature), values(log.file_name) count from datamodel=\"pan_aperture\" WHERE nodename=\"log.activity_monitoring\" $src_ip$ $dst_ip$ $serial_number$ $virtual_system$ \"$user|s$\" $app$ $category$ $action$ GROUPBY _time  log.client_ip log.user log.app\n| stats values AS * by _time log.app log.client_ip log.user | rename log.* as * </query>\n    <earliest>$time.earliest$</earliest>\n    <latest>$time.latest$</latest>\n  </search>\n  <fieldset autoRun=\"true\" submitButton=\"true\">\n    <input type=\"time\" searchWhenChanged=\"true\" token=\"time\">\n      <label></label>\n      <default>\n        <earliest>-60m</earliest>\n        <latest>now</latest>\n      </default>\n    </input>\n    <input type=\"text\" token=\"src_ip\">\n      <label>Source IP</label>\n      <default></default>\n      <prefix>log.client_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"dst_ip\">\n      <label>Destination IP</label>\n      <default></default>\n      <prefix>log.dst_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"serial_number\">\n      <label>Serial Number</label>\n      <prefix>(</prefix>\n      <suffix>)</suffix>\n      <default></default>\n    </input>\n    <input type=\"text\" token=\"virtual_system\">\n      <label>Vsys</label>\n      <default></default>\n      <prefix>log.vsys=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"user\">\n      <label>Source User</label>\n      <default></default>\n      <prefix>log.user=</prefix>\n    </input>\n    <input type=\"text\" token=\"app\">\n      <label>Application</label>\n      <default></default>\n      <prefix>log.app=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"category\">\n      <label>Category</label>\n      <default></default>\n      <prefix>log.categories=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"dropdown\" token=\"action\">\n      <label>Action</label>\n      <choice value=\"*\">ANY</choice>\n      <default>*</default>\n      <prefix>log.action=\"</prefix>\n      <suffix>\"</suffix>\n      <fieldForLabel>action</fieldForLabel>\n      <fieldForValue>action</fieldForValue>\n      <search>\n        <query>| inputlookup pan_vendor_actions.csv \n| fields action\n| dedup action\n| sort action</query>\n      </search>\n    </input>\n  </fieldset>\n  <row id=\"tooltip_row\">\n    <panel>\n    <html>\n      <div id=\"tooltip_title\">SaaS Activity</div>\n      <div id=\"tooltip_txt\">\n        <h4>Overview</h4>\n        <p>Activity related to Sanctioned and Unsanctioned SaaS applications.</p>\n        <h4>Products Shown</h4>\n        <ul>\n          <li>Aperture</li>\n          <li>Firewall or Panorama</li>\n        </ul>\n      </div>\n    </html>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <single>\n        <search base=\"basesearch\">\n          <query>| stats dc(app)</query>\n        </search>\n        <option name=\"drilldown\">all</option>\n        <option name=\"underLabel\">SaaS Applications</option>\n        <drilldown>\n          <link target=\"_self\">search?q=| tstats summariesonly=t prestats=t values(sourcetype), values(log.log_subtype), values(log.app:is_sanctioned_saas), values(log.app:risk), values(log.app:category), values(log.app:subcategory), values(log.bytes_in), values(log.bytes_out), values(log.action) count FROM datamodel=\"pan_firewall\" WHERE nodename=\"log.traffic.end\" log.app:is_saas=\"yes\" GROUPBY _time log.client_ip log.user log.app\n| tstats summariesonly=t prestats=t append=t values(sourcetype), values(log.log_subtype), values(log.action), values(log.object), values(log.object_path), values(log.severity), values(log.signature) count from datamodel=\"pan_aperture\" GROUPBY _time  log.client_ip log.user log.app\n| stats values AS * by _time log.app log.client_ip log.user | rename log.* as * | table app | dedup app&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </single>\n    </panel>\n    <panel>\n      <single>\n        <search base=\"basesearch\">\n          <query>| stats dc(user)</query>\n        </search>\n        <option name=\"drilldown\">all</option>\n        <option name=\"underLabel\">Users</option>\n        <drilldown>\n          <link target=\"_self\">search?q=| tstats summariesonly=t prestats=t values(sourcetype), values(log.log_subtype), values(log.app:is_sanctioned_saas), values(log.app:risk), values(log.app:category), values(log.app:subcategory), values(log.bytes_in), values(log.bytes_out), values(log.action) count FROM datamodel=\"pan_firewall\" WHERE nodename=\"log.traffic.end\" log.app:is_saas=\"yes\" GROUPBY _time log.client_ip log.user log.app\n| tstats summariesonly=t prestats=t append=t values(sourcetype), values(log.log_subtype), values(log.action), values(log.object), values(log.object_path), values(log.severity), values(log.signature) count from datamodel=\"pan_aperture\" GROUPBY _time  log.client_ip log.user log.app\n| stats values AS * by _time log.app log.client_ip log.user | rename log.* as * | table user | dedup user&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </single>\n    </panel>\n    <panel>\n      <single>\n        <search base=\"basesearch\">\n          <query>| eval tbytes= bytes_in + bytes_out | stats sum(tbytes) AS sbytes| sort -sbytes | eval \"Vol in MB\"=round(sbytes/1024/1024) | table \"Vol in MB\"</query>\n        </search>\n        <option name=\"drilldown\">none</option>\n        <option name=\"underLabel\">Megabytes</option>\n      </single>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>SaaS Usage</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>timechart count by app</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">area</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_logs` log_subtype=\"end\" OR log_subtype=\"activity_monitoring\" app:is_saas=\"yes\" app=$click.name2|s$ earliest=$click.value$ [| stats count | eval latest = $click.value$ %2b 300 | fields latest]&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>SaaS Actions</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| timechart count by action</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">column</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_logs` log_subtype=\"end\" OR log_subtype=\"activity_monitoring\" app:is_saas=\"yes\" action=$click.name2|s$ earliest=$click.value$ [| stats count | eval latest = $click.value$ %2b 300 | fields latest]&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <title>SaaS Latest File Actions</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| where log_subtype=\"activity_monitoring\" | table _time file_name action</query>\n        </search>\n        <option name=\"drilldown\">cell</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_logs` log_subtype=\"activity_monitoring\" file_name=$row.file_name|s$ action=$row.action$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>SaaS Distribution</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| stats sparkline count sum(bytes) AS sbytes by app app:category app:subcategory | sort -sbytes | head 8 | eval \"Vol in MB\"=round(sbytes/1024/1024) | rename sparkline AS distribution | rename vsys AS VSYS | rename count as sessions app:category AS category app:subcategory AS subcategory | table app category subcategory sessions \"Vol in MB\" distribution</query>\n        </search>\n        <option name=\"count\">10</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">cell</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"wrap\">true</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_logs` app=$row.app|s$ app:category=$row.category|s$ app:subcategory=$row.subcategory|s$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n    <panel>\n      <title>SaaS Statistics</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| stats sum(bytes) AS sbytes count as Sessions dc(user) as Users by app:is_sanctioned_saas | replace no with Non-sanctioned in app:is_sanctioned_saas | replace yes with Sanctioned in app:is_sanctioned_saas | sort -sbytes | eval \"Megabytes\"=round(sbytes/1024/1024) | rename app:is_sanctioned_saas as SaaS | table SaaS Users Megabytes Sessions</query>\n        </search>\n        <option name=\"count\">10</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">cell</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"wrap\">true</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_traffic` log_subtype=end app:is_saas=\"yes\" OR log_subtype=\"activity_monitoring\" | where $app:is_sanctioned_saas$=if(\"Sanctioned\"=$row.SaaS|s$,\"yes\",\"no\")&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Sanctioned SaaS Applications</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| search app:is_sanctioned_saas=\"yes\" | top limit=100 app</query>\n        </search>\n        <option name=\"drilldown\">cell</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/saas_activity?form.app=$row.app$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n    <panel>\n      <title>Non-Sanctioned SaaS Applications</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| search app:is_sanctioned_saas=\"no\" | top limit=100 app</query>\n        </search>\n        <option name=\"drilldown\">cell</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/saas_activity?form.app=$row.app$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>% SaaS Distribution</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| stats count by app:is_sanctioned_saas | replace no with Non-sanctioned in app:is_sanctioned_saas | replace yes with Sanctioned in app:is_sanctioned_saas | sort -count</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_traffic` log_subtype=end app:is_saas=\"yes\" $click.value$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <title>Top File Sharing SaaS Apps</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| eval tbytes= bytes_in + bytes_out | stats sum(tbytes) AS total_bytes by app | sort -total_bytes</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/saas_activity?form.app=$click.value$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Top Categories - Sanctioned</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| search app:is_sanctioned_saas=\"yes\" | top limit=5 app:subcategory</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">bar</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">none</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/saas_activity?form.category=$click.value$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <title>Top Categories - Non-Sanctioned</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| search app:is_sanctioned_saas=\"no\" | top limit=5 app:subcategory</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">bar</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">none</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/saas_activity?form.category=$click.value$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n</form>",
"eai:type": "views",
"name": "saas_activity",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<form version=\"1.1\" script=\"tooltip.js\" stylesheet=\"tooltip.css\">\n  <label>SaaS Security</label>\n  <description></description>\n  <search id=\"basesearch\">\n    <query>\n| tstats summariesonly=t prestats=t values(log.log_subtype) AS log.log_subtype, values(log.app) AS log.app, values(log.action) AS log.action count FROM datamodel=\"pan_firewall\" WHERE (nodename=\"log.url\" OR nodename=\"log.data\" OR nodename=\"log.file\" OR nodename=\"log.wildfire.malicious\") log.app:is_saas=\"yes\" $serial$ $vsys$ $client_ip$ $dst_ip$ \"$user|s$\" $app$ $action$ GROUPBY _time log.file_name log.user\n| tstats summariesonly=t prestats=t append=t values(log.log_subtype) AS log.log_subtype, values(log.app) AS log.app, values(log.action) AS log.action count FROM datamodel=\"pan_aperture\" WHERE nodename=\"log.incident\" $serial$ $vsys$ $client_ip$ $dst_ip$ \"$user|s$\" $app$ $action$ GROUPBY _time log.file_name log.user\n| stats values(log.log_subtype) AS log.log_subtype, values(log.app) AS log.app, values(log.action) AS log.action count BY _time log.file_name log.user\n| rename log.* AS *\n</query>\n    <earliest>$earliest$</earliest>\n    <latest>$latest$</latest>\n  </search>\n  <fieldset autoRun=\"true\" submitButton=\"true\">\n    <input type=\"time\" searchWhenChanged=\"true\">\n      <default>\n        <earliest>-60m</earliest>\n        <latest>now</latest>\n      </default>\n    </input>\n    <input type=\"text\" token=\"serial\">\n      <label>Serial Number</label>\n      <default></default>\n      <prefix>log.serial_number=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"vsys\">\n      <label>Virtual System</label>\n      <default></default>\n      <prefix>log.vsys=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"client_ip\">\n      <label>Client IP</label>\n      <default></default>\n      <prefix>log.client_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"dst_ip\">\n      <label>Destination IP</label>\n      <default></default>\n      <prefix>log.dst_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"user\">\n      <label>Source User</label>\n      <default></default>\n      <prefix>log.user=</prefix>\n    </input>\n    <input type=\"text\" token=\"app\">\n      <label>Application</label>\n      <default></default>\n      <prefix>log.app=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"dropdown\" token=\"action\">\n      <label>Action</label>\n      <choice value=\"*\">All</choice>\n      <default>*</default>\n      <prefix>log.action=\"</prefix>\n      <suffix>\"</suffix>\n      <fieldForLabel>action</fieldForLabel>\n      <fieldForValue>action</fieldForValue>\n      <search>\n        <query>| inputlookup pan_vendor_actions.csv \n| fields action\n| dedup action\n| sort action</query>\n      </search>\n    </input>\n  </fieldset>\n  <row id=\"tooltip_row\">\n    <panel>\n      <html>\n      <div id=\"tooltip_title\">SaaS Security</div>\n      <div id=\"tooltip_txt\">\n        <h4>Overview</h4>\n        <p>Threats related to Sanctioned and Unsanctioned SaaS application usage including network threats and threats residing within enterprise SaaS applications.</p>\n        <h4>Products Shown</h4>\n        <ul>\n          <li>Aperture</li>\n          <li>Firewall or Panorama</li>\n        </ul>\n      </div>\n    </html>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <single>\n        <search base=\"basesearch\">\n          <query>| where action=\"blocked\" | stats count</query>\n        </search>\n        <option name=\"drilldown\">none</option>\n        <option name=\"underLabel\">Blocked</option>\n      </single>\n      <single>\n        <search base=\"basesearch\">\n          <query>| stats count</query>\n        </search>\n        <option name=\"drilldown\">none</option>\n        <option name=\"underLabel\">Security Events</option>\n      </single>\n      <single>\n        <search base=\"basesearch\">\n          <query>| where action=\"allowed\" | stats count</query>\n        </search>\n        <option name=\"drilldown\">none</option>\n        <option name=\"underLabel\">Allowed</option>\n      </single>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>SaaS Incidents</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| where log_subtype=\"incident\" | table _time file_name user app</query>\n        </search>\n        <option name=\"drilldown\">cell</option>\n        <drilldown>\n          <link>\n            <![CDATA[\n            /app/SplunkforPaloAltoNetworks/search?q=`pan_traffic` log_subtype=$click.name2|s$ [| stats count | eval latest = $click.value$ %2b 300 | fields latest] earliest = $click.value$\n    ]]>\n          </link>\n        </drilldown>\n      </table>\n    </panel>\n    <panel>\n      <title>Malicious SaaS Files</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>|  where log_subtype=\"malicious\" | table _time file_name user app</query>\n        </search>\n        <option name=\"drilldown\">cell</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_logs` log_subtype=\"malicious\" file_name=\"$row.file_name|s$ user=\"$row.user|s$ app=$row.app|s$&amp;earliest=$undefined.earliest$&amp;latest=$undefined.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>SaaS Apps Over Time</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| timechart count by app</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">area</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <option name=\"height\">321</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_logs` \"app:is_saas\"=yes OR log_subtype=\"incident\" app=$click.name2|s$ [| stats count | eval latest = $click.value$ %2b 300 | fields latest] earliest = $click.value$&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <title>SaaS Threats by Type</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| search NOT action=allowed | timechart count by log_subtype</query>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">area</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_logs` \"app:is_saas\"=yes OR log_subtype=\"incident\" log_subtype=$click.name2|s$ [| stats count | eval latest = $click.value$ %2b 300 | fields latest] earliest = $click.value$&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n</form>",
"eai:type": "views",
"name": "saas_security",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<form version=\"1.1\" script=\"tooltip.js\" stylesheet=\"tooltip.css\">\n  <label>Threat Intelligence</label>\n  <row id=\"tooltip_row\">\n    <html>\n      <div id=\"tooltip_title\">Threat Intelligence</div>\n      <div id=\"tooltip_txt\">\n        <h4>Overview</h4>\n        <p>Threat Intelligence provides insight into the threat indicators being retrieved from MineMeld.  Threat indicators are used within the Palo Alto Networks Splunk app, and can also be exported to Splunk Enterprise Security.</p>\n        <h4>Products Shown</h4>\n        <ul>\n          <li>MineMeld</li>\n        </ul>\n      </div>\n    </html>\n  </row>\n  <row>\n    <panel>\n      <title>Top 10 Feeds</title>\n      <chart>\n        <search>\n          <query>| `mm_indicators` | stats count BY splunk_source | sort 10 -count</query>\n          <earliest>$earliest$</earliest>\n          <latest>$latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <drilldown>\n          <link target=\"_self\">search?q=| `mm_indicators` | search splunk_source=\"$click.value$\"&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <title>Top Indicator Types</title>\n      <chart>\n        <search>\n          <query>| `mm_indicators` | stats count BY type | sort -count</query>\n          <earliest>$earliest$</earliest>\n          <latest>$latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <drilldown>\n          <link target=\"_self\">search?q=| `mm_indicators($click.value$)`&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Average Indicators by Source (24 Hours)</title>\n      <chart>\n        <search>\n          <query>`mm_stats` | timechart avg(indicators) BY input_name</query>\n          <earliest>-24h@h</earliest>\n          <latest>now</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">line</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`mm_stats` earliest = $click.value$ [| stats count | eval latest = $click.value$ %2b 1200 | fields latest] | search input_name=$click.name2|s$&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n</form>",
"eai:type": "views",
"name": "threat_intelligence",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<form version=\"1.1\">\n  <label>User Behavior</label>\n  <search id=\"basesearch\">\n    <query>| tstats summariesonly=t latest(_time) AS _time, values(log.log_subtype) AS log.log_subtype, values(log.http_category) AS log.http_category, values(log.app:is_saas) AS log.app:is_saas, values(log.app:default_ports) AS log.app:default_ports, values(log.app) AS log.app, values(log.user) AS log.user, values(log.file_name) AS log.file_name, values(log.file_hash) AS log.file_hash, values(log.url) AS log.url, values(log.dest_name) AS log.dest_name, values(log.dest_port) AS log.dest_port, values(log.severity) AS log.severity, values(log.bytes_in) AS log.bytes_in, values(log.bytes_out) AS log.bytes_out count FROM datamodel=\"pan_firewall\" WHERE (nodename=\"log.traffic\" OR nodename=\"log.url\" OR nodename=\"log.data\") $src_ip$ $dest_ip$ $dest_name$ $log_subtype$ $app$ $category$ \"$user|s$\" $vsys$ $serial$ GROUPBY sourcetype log.serial_number log.session_id log.client_ip log.server_ip log.src_ip\n      | rename log.* AS *</query>\n    <earliest>$time.earliest$</earliest>\n    <latest>$time.latest$</latest>\n  </search>\n  <fieldset autoRun=\"true\" submitButton=\"true\">\n    <input type=\"time\" searchWhenChanged=\"true\" token=\"time\">\n      <label></label>\n      <default>\n        <earliest>-60m</earliest>\n        <latest>now</latest>\n      </default>\n    </input>\n    <input type=\"text\" token=\"serial\">\n      <label>Serial Number</label>\n      <prefix>log.serial_number=\"</prefix>\n      <suffix>\"</suffix>\n      <default></default>\n    </input>\n    <input type=\"text\" token=\"vsys\">\n      <label>Vsys</label>\n      <default></default>\n      <prefix>log.vsys=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"user\">\n      <label>User</label>\n      <default></default>\n      <prefix>log.user=</prefix>\n      <suffix></suffix>\n    </input>\n    <input type=\"text\" token=\"log_subtype\" searchWhenChanged=\"true\">\n      <label>Log Subtype</label>\n      <default></default>\n      <prefix>log.log_subtype=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"src_ip\">\n      <label>Source IP</label>\n      <default></default>\n      <prefix>log.src_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"dest_ip\">\n      <label>Destination IP</label>\n      <default></default>\n      <prefix>log.dest_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"dest_name\">\n      <label>Hostname</label>\n      <default></default>\n      <prefix>log.dest_name=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"app\">\n      <label>Application</label>\n      <default></default>\n      <prefix>log.app=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"category\">\n      <label>Web Category</label>\n      <default></default>\n      <prefix>log.http_category=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      <single>\n        <search base=\"basesearch\">\n          <query>| search log_subtype=\"end\" | stats count</query>\n        </search>\n        <option name=\"drilldown\">all</option>\n        <option name=\"underLabel\">Traffic Events</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/file_activity</link>\n        </drilldown>\n      </single>\n      <single>\n        <search base=\"basesearch\">\n          <query>| search log_subtype=\"data\" |  stats count</query>\n        </search>\n        <option name=\"drilldown\">all</option>\n        <option name=\"underLabel\">Data Events</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/user_behavior</link>\n        </drilldown>\n      </single>\n      <single>\n        <search base=\"basesearch\">\n          <query>| search log_subtype=\"url\" | stats count</query>\n        </search>\n        <option name=\"drilldown\">all</option>\n        <option name=\"underLabel\">URL Events</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/web_activity?form.time.earliest=$earliest$&amp;form.time.latest=$latest$</link>\n        </drilldown>\n      </single>\n      <single>\n        <search base=\"basesearch\">\n          <query>| search app:is_saas=\"yes\" | stats count</query>\n        </search>\n        <option name=\"drilldown\">all</option>\n        <option name=\"underLabel\">SaaS Events</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/saas_activity?form.time.earliest=$earliest$&amp;form.time.latest=$latest$</link>\n        </drilldown>\n      </single>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Top Hostnames</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| search log_subtype=\"url\" | stats sum(count) AS count by dest_name | sort -count</query>\n        </search>\n        <option name=\"count\">10</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">row</option>\n        <option name=\"wrap\">false</option>\n        <drilldown>\n          <set token=\"form.dest_name\">$click.value$</set>\n        </drilldown>\n      </table>\n    </panel>\n    <panel>\n      <title>Top Web Categories</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| search log_subtype=\"url\" | stats sum(count) AS count BY http_category | sort -count</query>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <drilldown>\n          <set token=\"form.category\">$click.value$</set>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <title>Top Applications</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| search log_subtype=\"url\" | stats sum(count) AS count BY app | sort -count</query>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <drilldown>\n          <set token=\"form.app\">$click.value$</set>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Possible Data Leaks</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| search log_subtype=\"data\" | stats sum(count) AS count BY user app file_name src_ip</query>\n        </search>\n        <option name=\"count\">20</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">row</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_logs` log_subtype=\"data\" | search src_ip=$row.src_ip$ file_name=$row.file_name$ app=$row.app$ user=$row.user|s$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Applications Not Using Default Port</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>|  search log_subtype=\"end\" app:default_ports!=\"*dynamic*\" | where not like('app:default_ports',\"%\".dest_port.\"%\") | stats count by app app:default_ports dest_port | sort -count | rename app:default_ports to default_ports | eval default_ports=split(default_ports, \"|\")</query>\n        </search>\n        <option name=\"count\">20</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">row</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_traffic` | search app=$row.app$ dest_port=$row.dest_port$ \"app:default_ports\"=$row.default_ports|s$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n    <panel>\n      <title>Rare Applications</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| search log_subtype=\"end\" | rare app</query>\n        </search>\n        <option name=\"count\">20</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">row</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n      </table>\n    </panel>\n  </row>\n</form>",
"eai:type": "views",
"name": "user_behavior",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<form version=\"1.1\">\n  <label>Web Activity</label>\n  <search id=\"basesearch\">\n    <query>| tstats summariesonly=t values(log.flags) AS log.flags, count FROM datamodel=pan_firewall WHERE nodename=\"log.url\" $serial$ $vsys$ $src_ip$ $dest_name$ \"$user|s$\" $app$ $content$ $category$ $action$ GROUPBY _time log.dest_name log.app:category log.app log.action log.content_type log.vendor_action | rename log.* AS * </query>\n    <earliest>$time.earliest$</earliest>\n    <latest>$time.latest$</latest>\n  </search>\n  <fieldset autoRun=\"true\" submitButton=\"true\">\n    <input type=\"time\" searchWhenChanged=\"true\" token=\"time\">\n      <default>\n        <earliest>-60m</earliest>\n        <latest>now</latest>\n      </default>\n    </input>\n    <input type=\"text\" token=\"serial\">\n      <label>Serial Number</label>\n      <prefix>log.serial_number=\"</prefix>\n      <suffix>\"</suffix>\n      <default></default>\n    </input>\n    <input type=\"text\" token=\"vsys\">\n      <label>Vsys</label>\n      <prefix>log.vsys=\"</prefix>\n      <suffix>\"</suffix>\n      <default></default>\n    </input>\n    <input type=\"text\" token=\"src_ip\">\n      <label>Source IP</label>\n      <default></default>\n      <prefix>log.src_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"dest_name\">\n      <label>Destination Hostname</label>\n      <default></default>\n      <prefix>log.dest_name=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"user\">\n      <label>User</label>\n      <default></default>\n      <prefix>log.user=</prefix>\n    </input>\n    <input type=\"text\" token=\"app\">\n      <label>Application</label>\n      <default></default>\n      <prefix>log.app=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"category\">\n      <label>Category</label>\n      <default></default>\n      <prefix>log.category=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"content\">\n      <label>Content Type</label>\n      <default></default>\n      <prefix>log.content_type=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"dropdown\" token=\"action\">\n      <label>Action</label>\n      <default>*</default>\n      <search>\n        <query>| fields action\n| dedup action\n| sort action</query>\n      </search>\n      <fieldForLabel>action</fieldForLabel>\n      <fieldForValue>action</fieldForValue>\n      <choice value=\"*\">All</choice>\n      <prefix>log.action=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n  </fieldset>\n  <row>\n    <panel>\n      <title>Web Destinations</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| stats sum(count) AS count values(app) AS app values(category) AS category BY dest_name\n| table dest_name app category count\n| sort -count</query>\n        </search>\n        <option name=\"count\">10</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">cell</option>\n        <option name=\"rowNumbers\">true</option>\n        <option name=\"wrap\">false</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_url` $click.name$=$click.value|s$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Categories</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>|  stats count BY app:category\n| sort -count</query>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/web_activity?form.category=$click.value$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <title>Applications</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| stats count BY app\n| sort -count</query>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/web_activity?form.app=$click.value$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <title>Content Type</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| stats count BY content_type\n| sort -count</query>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">visible</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">default</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">right</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/web_activity?form.content=$click.value$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Requests Over Time By Action</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| timechart count by action</query>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.chart\">column</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.legend.placement\">bottom</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_url` action=$click.name2|s$ earliest=$click.value$ [| stats count | eval latest = $click.value$ %2b 300 | fields latest]&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <title>Methods Over Time</title>\n      <chart>\n        <search>\n          <query>`pan_url` \n| timechart count by http_method</query>\n          <earliest>$time.earliest$</earliest>\n          <latest>$time.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.overflowMode\">ellipsisNone</option>\n        <option name=\"charting.axisLabelsX.majorLabelStyle.rotation\">0</option>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">visible</option>\n        <option name=\"charting.axisTitleY2.visibility\">visible</option>\n        <option name=\"charting.axisX.scale\">linear</option>\n        <option name=\"charting.axisY.scale\">linear</option>\n        <option name=\"charting.axisY2.enabled\">0</option>\n        <option name=\"charting.axisY2.scale\">inherit</option>\n        <option name=\"charting.chart\">column</option>\n        <option name=\"charting.chart.bubbleMaximumSize\">50</option>\n        <option name=\"charting.chart.bubbleMinimumSize\">10</option>\n        <option name=\"charting.chart.bubbleSizeBy\">area</option>\n        <option name=\"charting.chart.nullValueMode\">gaps</option>\n        <option name=\"charting.chart.showDataLabels\">none</option>\n        <option name=\"charting.chart.sliceCollapsingThreshold\">0.01</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.chart.style\">shiny</option>\n        <option name=\"charting.drilldown\">all</option>\n        <option name=\"charting.layout.splitSeries\">0</option>\n        <option name=\"charting.layout.splitSeries.allowIndependentYRanges\">0</option>\n        <option name=\"charting.legend.labelStyle.overflowMode\">ellipsisMiddle</option>\n        <option name=\"charting.legend.placement\">bottom</option>\n        <option name=\"trellis.enabled\">0</option>\n        <option name=\"trellis.scales.shared\">1</option>\n        <option name=\"trellis.size\">medium</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_url` method=$click.name2|s$ earliest=$click.value$ [| stats count | eval latest = $click.value$ %2b 300 | fields latest]&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Hostnames Block-Continue</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| stats count BY dest_name vendor_action | search vendor_action=\"block-continue\" | sort -count </query>\n          <earliest>$time.earliest$</earliest>\n          <latest>$time.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">8</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">row</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_url` vendor_action=\"block-continue\" dest_name=$row.dest_name|s$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n    <panel>\n      <title>Top Referrers</title>\n      <table>\n        <search>\n          <query>`pan_url`\n          | where dest_name!=http_referrer_name\n          | stats count by http_referrer_name\n          | sort -count</query>\n          <earliest>$time.earliest$</earliest>\n          <latest>$time.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">8</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">row</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/web_activity?form.dest_name=$row.http_referrer_name$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n    <panel>\n      <title>Top File Downloads</title>\n      <table>\n        <search>\n          <query>`pan_url`\n            | where http_method==\"GET\" \n            | stats count by file_name\n            | sort -count</query>\n          <earliest>$time.earliest$</earliest>\n          <latest>$time.latest$</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">8</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">row</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">false</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_url` http_method==\"GET\" \nfile_name=$row.file_name|s$&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Decrypted Traffic</title>\n      <table>\n        <search>\n          <query>| tstats summariesonly=t values(log.flags) AS log.flags, values(log.user) AS log.user, count FROM datamodel=pan_firewall WHERE nodename=\"log.url\" GROUPBY _time log.src_ip log.dest_name log.category log.app log.action log.content_type log.vendor_action | rename log.* AS * | search flags=\"decrypted\" | table _time src_ip user dest_name category app flags count</query>\n          <earliest>-60m</earliest>\n          <latest>now</latest>\n          <sampleRatio>1</sampleRatio>\n        </search>\n        <option name=\"count\">20</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">cell</option>\n        <option name=\"percentagesRow\">false</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"totalsRow\">false</option>\n        <option name=\"wrap\">true</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_url` flags=\"decrypted\"&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n</form>",
"eai:type": "views",
"name": "web_activity",
"owner": "nobody",
"sharing": "app"
},
{
"eai:data": "<form version=\"1.1\" script=\"tooltip.js\" stylesheet=\"tooltip.css\">\n  <label>WildFire Submissions</label>\n  <search id=\"basesearch\">\n    <query>| `pan_tstats` count FROM `node(log.wildfire)` $vsys$ $serial$ $src_ip$ $dest_ip$ \"$user|s$\" $src_location$ $file_name$ $file_type$ $app$ groupby _time log.rule log.src_ip log.dest_ip log.verdict log.file_name log.file_type log.user log.app log.file_hash log.src_location| rename log.* AS *</query>\n    <earliest>$time.earliest$</earliest>\n    <latest>$time.latest$</latest>\n  </search>\n  <fieldset autoRun=\"true\" submitButton=\"true\">\n    <input type=\"time\" searchWhenChanged=\"true\" token=\"time\">\n      <label></label>\n      <default>\n        <earliest>-60m</earliest>\n        <latest>now</latest>\n      </default>\n    </input>\n    <input type=\"text\" token=\"serial\">\n      <label>Serial Number</label>\n      <prefix>log.serial_number=\"</prefix>\n      <suffix>\"</suffix>\n      <default></default>\n    </input>\n    <input type=\"text\" token=\"vsys\">\n      <label>Virtual System</label>\n      <prefix>log.vsys=\"</prefix>\n      <suffix>\"</suffix>\n      <default></default>\n    </input>\n    <input type=\"text\" token=\"src_ip\">\n      <label>Source IP</label>\n      <default></default>\n      <prefix>log.src_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"dest_ip\">\n      <label>Destination IP</label>\n      <default></default>\n      <prefix>log.dest_ip=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"file_name\">\n      <label>Filename</label>\n      <default></default>\n      <prefix>log.file_name=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"file_type\">\n      <label>File Type</label>\n      <default></default>\n      <prefix>log.file_type=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n    <input type=\"text\" token=\"user\">\n      <label>User</label>\n      <default></default>\n      <prefix>log.user=</prefix>\n    </input>\n    <input type=\"text\" token=\"src_location\">\n      <label>Location</label>\n      <default></default>\n      <prefix>log.src_location=</prefix>\n    </input>\n    <input type=\"text\" token=\"app\">\n      <label>Application</label>\n      <default></default>\n      <prefix>log.app=\"</prefix>\n      <suffix>\"</suffix>\n    </input>\n  </fieldset>\n  <row id=\"tooltip_row\">\n    <panel>\n      <html>\n        <div id=\"tooltip_title\">WildFire Submissions</div>\n        <div id=\"tooltip_txt\">\n          <h4>Overview</h4>\n          <p>WildFire is an advanced analysis and prevention engine for highly\n          evasive zero-day exploits and malware. Files can be sent for analysis from the\n          firewall and will show in this dashboard when analyzed.</p>\n          <h4>Products Shown</h4>\n          <ul>\n            <li>Firewall or Panorama</li>\n            <li>WildFire</li>\n          </ul>\n        </div>\n      </html>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>WildFire Submissions</title>\n      <single>\n        <search base=\"basesearch\">\n          <query>| search verdict=\"malicious\" | stats count</query>\n        </search>\n        <option name=\"drilldown\">none</option>\n        <option name=\"rangeColors\">[\"0xd93f3c\",\"0xd93f3c\"]</option>\n        <option name=\"rangeValues\">[50]</option>\n        <option name=\"underLabel\">Malicious</option>\n        <option name=\"useColors\">1</option>\n      </single>\n      <single>\n        <search base=\"basesearch\">\n          <query>| search verdict=\"phishing\" | stats count</query>\n        </search>\n        <option name=\"drilldown\">none</option>\n        <option name=\"rangeColors\">[\"0xf58f39\",\"0xf58f39\"]</option>\n        <option name=\"rangeValues\">[50]</option>\n        <option name=\"underLabel\">Phishing</option>\n        <option name=\"useColors\">1</option>\n      </single>\n      <single>\n        <search base=\"basesearch\">\n          <query>| search verdict=\"grayware\" | stats count</query>\n        </search>\n        <option name=\"drilldown\">none</option>\n        <option name=\"rangeColors\">[\"0xf7bc38\",\"0xf7bc38\"]</option>\n        <option name=\"rangeValues\">[50]</option>\n        <option name=\"underLabel\">Grayware</option>\n        <option name=\"useColors\">1</option>\n      </single>\n      <single>\n        <search base=\"basesearch\">\n          <query>| search verdict=\"benign\" | stats count</query>\n        </search>\n        <option name=\"drilldown\">none</option>\n        <option name=\"rangeColors\">[\"0x6db7c6\",\"0x6db7c6\"]</option>\n        <option name=\"rangeValues\">[50]</option>\n        <option name=\"underLabel\">Benign</option>\n        <option name=\"useColors\">1</option>\n      </single>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>WildFire Submissions Over Time By Verdict</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| timechart sum(count) by verdict</query>\n        </search>\n        <option name=\"charting.axisTitleX.visibility\">collapsed</option>\n        <option name=\"charting.axisTitleY.visibility\">collapsed</option>\n        <option name=\"charting.chart.stackMode\">stacked</option>\n        <option name=\"charting.fieldColors\">{\"malicious\":#D93F3C,\"phishing\":#F58F39,\"grayware\":#F7BC38,\"benign\":#6DB7C6}</option>\n        <option name=\"charting.legend.labels\">[malicious,phishing,grayware,benign]</option>\n        <drilldown>\n          <link target=\"_self\">search?q=`pan_wildfire` verdict=$click.name2|s$ earliest=$click.value$ [| stats count | eval latest = $click.value$ %2b 300 | fields latest]&amp;earliest=$earliest$&amp;latest=$latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Top Applications</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| top limit=100 app</query>\n        </search>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.drilldown\">all</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/wildfire_submissions?form.$click.name$=$click.value$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <title>Top File Types</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| top limit=100 file_type</query>\n        </search>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.drilldown\">all</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/wildfire_submissions?form.file_type=$click.value$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n    <panel>\n      <title>Top Source Locations</title>\n      <chart>\n        <search base=\"basesearch\">\n          <query>| top limit=100 src_location</query>\n        </search>\n        <option name=\"charting.chart\">pie</option>\n        <option name=\"charting.drilldown\">all</option>\n        <drilldown>\n          <link target=\"_self\">/app/SplunkforPaloAltoNetworks/wildfire_submissions?form.src_location=$click.value|s$&amp;form.time.earliest=$time.earliest$&amp;form.time.latest=$time.latest$</link>\n        </drilldown>\n      </chart>\n    </panel>\n  </row>\n  <row>\n    <panel>\n      <title>Recent WildFire Submissions</title>\n      <table>\n        <search base=\"basesearch\">\n          <query>| search verdict!=\"benign\" | eval autofocus=\"Open in AutoFocus\" | table _time verdict rule file_name file_type app src_ip dest_ip user autofocus file_hash | sort -_time</query>\n        </search>\n        <option name=\"count\">20</option>\n        <option name=\"dataOverlayMode\">none</option>\n        <option name=\"drilldown\">row</option>\n        <option name=\"rowNumbers\">false</option>\n        <option name=\"wrap\">false</option>\n        <fields>[\"_time\",\"verdict\",\"rule\",\"file_name\",\"file_type\",\"app\",\"src_ip\",\"dest_ip\",\"user\",\"autofocus\"]</fields>\n        <drilldown>\n          <condition field=\"autofocus\">\n            <link target=\"autofocus\">https://autofocus.paloaltonetworks.com/#/sample/$row.file_hash$</link>\n          </condition>\n          <condition field=\"*\">\n            <link target=\"_self\">search?q=`pan_logs` (eventtype=\"pan_wildfire\" file_hash=$row.file_hash|s$)&amp;earliest=$time.earliest$&amp;latest=$time.latest$</link>\n          </condition>\n        </drilldown>\n      </table>\n    </panel>\n  </row>\n</form>",
"eai:type": "views",
"name": "wildfire_submissions",
"owner": "nobody",
"sharing": "app"
}
]
